# SHUSTERI AUTOMATION - –ü–û–õ–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ò –ò–°–•–û–î–ù–´–ô –ö–û–î

---

## üìö –ß–ê–°–¢–¨ 1: –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

# Shusteri Automation - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–ø–æ—Ç–æ–∫-–¥–∞–Ω–Ω—ã—Ö)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
5. [–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞](#–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
6. [–ú–æ–¥—É–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–º–æ–¥—É–ª–∏-–∏-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
   - 6.1. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π "–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫"](#6-km_loaderpy---–∑–∞–≥—Ä—É–∑—á–∏–∫-–∫–æ–¥–æ–≤-–º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏-—á–µ—Å—Ç–Ω—ã–π-–∑–Ω–∞–∫)
7. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
8. [–§–æ—Ä–º–∞—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤](#—Ñ–æ—Ä–º–∞—Ç—ã-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
9. [–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
10. [–ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#–ø—Ä–∏–º–µ—Ä—ã-–¥–∞–Ω–Ω—ã—Ö)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±—É–≤–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ Shusteri. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–∏—Ç–∞–π—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ—Å—Ç–∞–≤–æ–∫ –≤ —Ç—Ä–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞: Commercial Invoice, Specification –∏ Packing List.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–µ—Ö —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Invoice, Specification, Packing List)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ—Å–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–º—É–ª—å—Ç–∏–∫–ª–∏–µ–Ω—Ç–Ω–æ—Å—Ç—å)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª–∏–Ω—ã —Å—Ç–µ–ª—å–∫–∏ (‚â§24—Å–º / >24—Å–º)
- –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–æ–≤ –¢–ù –í–≠–î (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ/—Ä–∞–∑–Ω—ã–µ –∫–æ–¥—ã)
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π "–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫"** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ö–ú –∫–æ–¥–æ–≤ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö —Ä–µ–∂–∏–º–æ–≤: –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≥—Ä—É–∑–æ–≤ (–ø–æ–ª—É–ø–∞—Ä—ã)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
```
Python 3.8+
‚îú‚îÄ‚îÄ pandas 2.1.4          # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ openpyxl 3.1.2        # –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å Excel
‚îú‚îÄ‚îÄ xlsxwriter 3.1.9      # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ rich 13.7.0           # –ö—Ä–∞—Å–∏–≤—ã–π CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ pydantic 2.5.0        # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ PyYAML 6.0.1          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ click 8.1.7           # CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –û–±—â–∞—è —Å—Ö–µ–º–∞
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –í—Ö–æ–¥–Ω–æ–π Excel  ‚îÇ  (–∫–∏—Ç–∞–π—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  InputFileParser‚îÇ  (–ø–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  DataProcessor  ‚îÇ  (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Generators    ‚îÇ  (—Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
‚îÇ  ‚îú‚îÄInvoice      ‚îÇ
‚îÇ  ‚îú‚îÄSpecification‚îÇ
‚îÇ  ‚îî‚îÄPackingList  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Formatters    ‚îÇ  (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ)
‚îÇ  ‚îú‚îÄInvoice      ‚îÇ
‚îÇ  ‚îú‚îÄSpecification‚îÇ
‚îÇ  ‚îî‚îÄPackingList  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í—ã—Ö–æ–¥–Ω—ã–µ Excel  ‚îÇ  (3 —Ñ–∞–π–ª–∞ –∏–ª–∏ 1 —Ñ–∞–π–ª —Å 3 –ª–∏—Å—Ç–∞–º–∏)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

```
–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:
–ê–†–¢–ò–ö–£–õ: "ABC123"
–ö–û–î: "6403911100/6403911800"  ‚Üê –†–ê–ó–ù–´–ï –∫–æ–¥—ã
–†–∞–∑–º–µ—Ä—ã: 35(10—à—Ç), 36(20—à—Ç), 37(15—à—Ç), 38(25—à—Ç), 39(30—à—Ç)

     ‚Üì PARSER

ProductLine:
- article: "ABC123"
- hs_code_le24: "6403911100"
- hs_code_gt24: "6403911800"
- qty_by_size: {35:10, 36:20, 37:15, 38:25, 39:30}

     ‚Üì PROCESSOR (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç: –∫–æ–¥—ã –†–ê–ó–ù–´–ï ‚Üí —Å–æ–∑–¥–∞—Ç—å 2 —Å—Ç—Ä–æ–∫–∏)

OutputLine #1:
- article: "ABC123"
- hs_code: "6403911100"
- insole_category: "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º"
- quantity: 45 (10+20+15)
- boxes: 5

OutputLine #2:
- article: "ABC123"
- hs_code: "6403911800"
- insole_category: "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –±–æ–ª–µ–µ 24—Å–º"
- quantity: 55 (25+30)
- boxes: 0  ‚Üê —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ!

     ‚Üì GENERATOR (—Å–æ–∑–¥–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç)

–¢–∞–±–ª–∏—Ü–∞ –≤ Excel:
1  ‚îÇ BRAND ‚îÇ 6403911100 ‚îÇ ABC123 ‚îÇ –æ–ø–∏—Å–∞–Ω–∏–µ + –¥–æ 24—Å–º     ‚îÇ 45  ‚îÇ ... ‚îÇ 5   ‚îÇ
   ‚îÇ       ‚îÇ 6403911800 ‚îÇ        ‚îÇ –æ–ø–∏—Å–∞–Ω–∏–µ + –±–æ–ª–µ–µ 24—Å–º  ‚îÇ 55  ‚îÇ ... ‚îÇ  ‚Üë  ‚îÇ
                                                                        ‚îÇ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã ‚îÇ
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
shusteri-automation/
‚îú‚îÄ‚îÄ src/                          # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Pydantic –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ parser.py                 # –ü–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö Excel —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ processor.py              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ generators/               # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ invoice.py           # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Invoice
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ specification.py     # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Specification
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ packing_list.py      # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Packing List
‚îÇ   ‚îî‚îÄ‚îÄ formatters/               # –§–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã Excel
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ invoice_formatter.py
‚îÇ       ‚îú‚îÄ‚îÄ specification_formatter.py
‚îÇ       ‚îî‚îÄ‚îÄ packing_list_formatter.py
‚îú‚îÄ‚îÄ presets/                      # YAML –ø—Ä–µ—Å–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ client_example.yaml
‚îú‚îÄ‚îÄ input/                        # –í—Ö–æ–¥–Ω—ã–µ Excel —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ output/                       # –í—ã—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ config.yaml                   # –û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt              # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ run.py                        # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ automation.log                # –õ–æ–≥ —Ñ–∞–π–ª
```

---

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### ProductLine (–≤—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
```python
class ProductLine(BaseModel):
    """–û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
    row_number: int                    # –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ Excel
    brand: str                         # –ú–∞—Ä–∫–∞ (‰æã: "BETSY")
    article: str                       # –ê—Ä—Ç–∏–∫—É–ª (‰æã: "998089/05-01")
    code_raw: str                      # –ö–æ–¥ –≤ —Å—ã—Ä–æ–º –≤–∏–¥–µ (‰æã: "6403911100/6403911800")
    hs_code_le24: str                  # HS –∫–æ–¥ –¥–ª—è ‚â§24—Å–º
    hs_code_gt24: str                  # HS –∫–æ–¥ –¥–ª—è >24—Å–º
    name: str                          # –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
    material: str                      # –ú–∞—Ç–µ—Ä–∏–∞–ª –≤–µ—Ä—Ö–∞
    color: str                         # –¶–≤–µ—Ç
    lining: str                        # –ü–æ–¥–∫–ª–∞–¥–∫–∞
    sole: str                          # –ü–æ–¥–æ—à–≤–∞
    heel_height: str                   # –í—ã—Å–æ—Ç–∞ –∫–∞–±–ª—É–∫–∞
    composition: Optional[str]         # –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Å–æ—Å—Ç–∞–≤
    price: Decimal                     # –¶–µ–Ω–∞ –∑–∞ –ø–∞—Ä—É
    boxes: int                         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–æ–±–æ–∫
    net_weight_per_pair: Decimal       # –í–µ—Å –Ω–µ—Ç—Ç–æ –Ω–∞ –ø–∞—Ä—É
    gross_weight_per_box: Decimal      # –í–µ—Å –±—Ä—É—Ç—Ç–æ –∑–∞ –∫–æ—Ä–æ–±–∫—É
    qty_by_size: dict                  # {35: 100, 36: 200, ...}
    
    # –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:
    @property
    def total_pairs(self) -> int:
        """–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä"""
        return sum(self.qty_by_size.values())
    
    @property
    def pairs_le24(self) -> int:
        """–ü–∞—Ä—ã ‚â§24—Å–º (—Ä–∞–∑–º–µ—Ä—ã 35-37)"""
        return sum(qty for size, qty in self.qty_by_size.items()
                   if size in [35, 36, 37])
    
    @property
    def pairs_gt24(self) -> int:
        """–ü–∞—Ä—ã >24—Å–º (—Ä–∞–∑–º–µ—Ä—ã 38+)"""
        return sum(qty for size, qty in self.qty_by_size.items()
                   if size in [38, 39, 40, 41, 42])
```

### OutputLine (—Å—Ç—Ä–æ–∫–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞)
```python
class OutputLine(BaseModel):
    """–°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""
    brand: str                         # –ú–∞—Ä–∫–∞
    hs_code: str                       # –ö–æ–¥ –¢–ù –í–≠–î (–æ–¥–∏–Ω!)
    article: str                       # –ê—Ä—Ç–∏–∫—É–ª
    description: str                   # –û–ø–∏—Å–∞–Ω–∏–µ
    color: str                         # –¶–≤–µ—Ç
    material: str                      # –ú–∞—Ç–µ—Ä–∏–∞–ª –≤–µ—Ä—Ö–∞
    lining: str                        # –ü–æ–¥–∫–ª–∞–¥–∫–∞
    sole: str                          # –ü–æ–¥–æ—à–≤–∞
    heel_height: str                   # –í—ã—Å–æ—Ç–∞ –∫–∞–±–ª—É–∫–∞
    insole_category: str               # "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º" –ò–õ–ò 
                                       # "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –±–æ–ª–µ–µ 24—Å–º" –ò–õ–ò
                                       # "–≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã 35-39"
    quantity: int                      # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    net_weight: Decimal                # –í–µ—Å –Ω–µ—Ç—Ç–æ (–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    gross_weight: Decimal              # –í–µ—Å –±—Ä—É—Ç—Ç–æ (–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    boxes: int                         # –ö–æ—Ä–æ–±–∫–∏ (0 –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã)
    original_boxes: int                # –í–ê–ñ–ù–û: –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
    price: Decimal                     # –¶–µ–Ω–∞ –∑–∞ –ø–∞—Ä—É
    amount: Decimal                    # –°—É–º–º–∞ (price * quantity)
    kiz_codes: List[str]               # –ö–ò–ó –∫–æ–¥—ã (–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –æ–±—ã—á–Ω–æ)
```

### DocumentMetadata (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞)
```python
class DocumentMetadata(BaseModel):
    """–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""
    invoice_number: str                # –ù–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞
    date: str                          # –î–∞—Ç–∞
    container_number: str              # –ù–æ–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    seller_name: str                   # –ü—Ä–æ–¥–∞–≤–µ—Ü (RU)
    seller_name_en: str                # –ü—Ä–æ–¥–∞–≤–µ—Ü (EN)
    seller_address: str                # –ê–¥—Ä–µ—Å –ø—Ä–æ–¥–∞–≤—Ü–∞ (RU)
    seller_address_en: str             # –ê–¥—Ä–µ—Å –ø—Ä–æ–¥–∞–≤—Ü–∞ (EN)
    buyer_name: str                    # –ü–æ–∫—É–ø–∞—Ç–µ–ª—å
    buyer_address: str                 # –ê–¥—Ä–µ—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (RU)
    buyer_address_en: str              # –ê–¥—Ä–µ—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (EN)
    contract_number: str               # –ù–æ–º–µ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    contract_date: str                 # –î–∞—Ç–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    terms_of_delivery: str             # –£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏ (‰æã: "FCA")
    currency: str                      # –í–∞–ª—é—Ç–∞ (‰æã: "CNY")
```

---

## –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### 1. –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –¥–ª–∏–Ω—ã —Å—Ç–µ–ª—å–∫–∏
```yaml
size_to_insole:
  "35": 22.5  # ‚â§24—Å–º
  "36": 23.0  # ‚â§24—Å–º
  "37": 24.0  # ‚â§24—Å–º (–≥—Ä–∞–Ω–∏—Ü–∞)
  "38": 24.5  # >24—Å–º
  "39": 25.0  # >24—Å–º
  "40": 25.5  # >24—Å–º
  "41": 26.0  # >24—Å–º
  "42": 26.5  # >24—Å–º

insole_boundary: 24.0  # –ì—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–°–¢–†–û–ì–û)
```

### 2. –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ –∫–æ–¥–∞–º –¢–ù –í–≠–î (–ö–†–ò–¢–ò–ß–ù–û!)

```python
def process(products: List[ProductLine]) -> List[OutputLine]:
    output_lines = []
    
    for product in products:
        # –ü–†–û–í–ï–†–ö–ê: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ª–∏ –∫–æ–¥—ã?
        codes_are_same = (product.hs_code_le24 == product.hs_code_gt24)
        
        if codes_are_same:
            # –í–ê–†–ò–ê–ù–¢ 1: –ö–æ–¥ –û–î–ò–ù ‚Üí —Å–æ–∑–¥–∞–µ–º –û–î–ù–£ —Å—Ç—Ä–æ–∫—É —Å–æ –í–°–ï–ú–ò —Ä–∞–∑–º–µ—Ä–∞–º–∏
            output_lines.append(create_line(
                product,
                category="all",
                quantity=product.total_pairs
            ))
        else:
            # –í–ê–†–ò–ê–ù–¢ 2: –ö–æ–¥—ã –†–ê–ó–ù–´–ï ‚Üí —Å–æ–∑–¥–∞–µ–º –î–í–ï —Å—Ç—Ä–æ–∫–∏
            
            # –°—Ç—Ä–æ–∫–∞ 1: ‚â§24—Å–º
            if product.pairs_le24 > 0:
                output_lines.append(create_line(
                    product,
                    category="le24",
                    quantity=product.pairs_le24
                ))
            
            # –°—Ç—Ä–æ–∫–∞ 2: >24—Å–º
            if product.pairs_gt24 > 0:
                output_lines.append(create_line(
                    product,
                    category="gt24",
                    quantity=product.pairs_gt24
                ))
    
    return output_lines
```

**–ö–õ–Æ–ß–ï–í–û–ô –ú–û–ú–ï–ù–¢:**
- –ï—Å–ª–∏ –≤–æ –≤—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –ë–ï–ó —Å–ª—ç—à–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `6403911100`) ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è –û–î–ù–ê —Å—Ç—Ä–æ–∫–∞
- –ï—Å–ª–∏ –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –°–û —Å–ª—ç—à–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä: `6403911100/6403911800`) ‚Üí —Å–æ–∑–¥–∞—é—Ç—Å—è –î–í–ï —Å—Ç—Ä–æ–∫–∏

### 3. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫ boxes

**–ü—Ä–∞–≤–∏–ª–æ:** –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è –î–í–ï —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞ (—Ä–∞–∑–Ω—ã–µ –∫–æ–¥—ã –¢–ù –í–≠–î):
1. –í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ (‚â§24—Å–º): `boxes = N`, –≥–¥–µ N - –∏—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–æ–±–æ–∫ –∏–∑ —Ñ–∞–π–ª–∞
2. –í–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ (>24—Å–º): `boxes = 0`
3. **–ü—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:** —ç—Ç–∏ –¥–≤–µ —è—á–µ–π–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ, –∏ –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π —è—á–µ–π–∫–µ –ø–∏—à–µ—Ç—Å—è `original_boxes`

**–ü—Ä–∏–º–µ—Ä:**
```
–í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª:
–ê–†–¢–ò–ö–£–õ: ABC123, –ö–û–î: 6403911100/6403911800, –ö–û–†–û–ë–ö–ò: 10

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (2 —Å—Ç—Ä–æ–∫–∏):
Line 1: boxes=10, original_boxes=10
Line 2: boxes=0,  original_boxes=10

–í Excel (–ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è):
‚îÇ ABC123 ‚îÇ ... ‚îÇ ‚îå‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ        ‚îÇ ... ‚îÇ ‚îÇ10‚îÇ ‚îÇ  ‚Üê –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —è—á–µ–π–∫–∞
                ‚îî‚îÄ‚îÄ‚îò
```

### 4. –ü–æ–¥—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤ (Total)

**–ö–†–ò–¢–ò–ß–ù–û:** –ü—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ `total_boxes` –ù–ï –¥—É–±–ª–∏—Ä—É–µ–º –∫–æ—Ä–æ–±–∫–∏ –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã!

```python
total_boxes = 0

for line in lines:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–æ–π –ø–∞—Ä—ã?
    is_continuation = (
        prev_line is not None and
        line.article == prev_line.article and
        "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
        line.boxes == 0 and
        "–¥–æ 24—Å–º" in prev_line.insole_category
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º boxes —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫!
    if not is_continuation:
        total_boxes += line.boxes
```

---

## –ú–æ–¥—É–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. models.py - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Pydantic

**–ö–ª–∞—Å—Å—ã:**
- `ProductLine` - –≤—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ Excel —Ñ–∞–π–ª–∞
- `OutputLine` - —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `DocumentMetadata` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–∏–Ω–≤–æ–π—Å, –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∏ —Ç.–¥.)

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Decimal` –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ (—Ç–æ—á–Ω–æ—Å—Ç—å!)
- –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ (@property) –¥–ª—è –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞—Ä
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Å—Ç–µ–ª—å–∫–∏

### 2. parser.py - –ü–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ß—Ç–µ–Ω–∏–µ –∫–∏—Ç–∞–π—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã Excel –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ `ProductLine`

**–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥:** `parse(file_path: str) -> List[ProductLine]`

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ß–∏—Ç–∞–µ—Ç Excel —Ñ–∞–π–ª —á–µ—Ä–µ–∑ pandas
2. –£–¥–∞–ª—è–µ—Ç –ø—É—Å—Ç—ã–µ –∏ –∏—Ç–æ–≥–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
3. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ü–∞—Ä—Å–∏—Ç –∫–æ–¥ –¢–ù –í–≠–î (—Ä–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ `/` –µ—Å–ª–∏ –µ—Å—Ç—å)
   - –°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º (35-42)
   - –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç `ProductLine`
4. –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–æ–≤ –¢–ù –í–≠–î:**
```python
def _parse_hs_code(self, code_raw: str) -> Tuple[str, str]:
    if '/' in code_raw:
        # –†–∞–∑–Ω—ã–µ –∫–æ–¥—ã –¥–ª—è ‚â§24—Å–º –∏ >24—Å–º
        parts = code_raw.split('/')
        return parts[0].strip(), parts[1].strip()
    else:
        # –û–¥–∏–Ω –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
        return code_raw.strip(), code_raw.strip()
```

### 3. processor.py - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `ProductLine` ‚Üí `OutputLine` —Å —É—á–µ—Ç–æ–º –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

**–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥:** `process(products: List[ProductLine]) -> List[OutputLine]`

**–õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫:**

```python
for product in products:
    codes_are_same = (product.hs_code_le24 == product.hs_code_gt24)
    
    if codes_are_same:
        # –û–î–ò–ù –∫–æ–¥ ‚Üí –û–î–ù–ê —Å—Ç—Ä–æ–∫–∞ —Å–æ –≤—Å–µ–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
        output_line = create_line(
            product,
            category="all",
            quantity=product.total_pairs
        )
    else:
        # –†–ê–ó–ù–´–ï –∫–æ–¥—ã ‚Üí –î–í–ï —Å—Ç—Ä–æ–∫–∏ (‚â§24—Å–º –∏ >24—Å–º)
        line_le24 = create_line(product, category="le24", ...)
        line_gt24 = create_line(product, category="gt24", ...)
```

**–†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤:**
- Net weight: `net_weight_per_pair * quantity`
- Gross weight: –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Ç –æ–±—â–µ–≥–æ –±—Ä—É—Ç—Ç–æ –∑–∞ –≤—Å–µ –∫–æ—Ä–æ–±–∫–∏

**–í–∞–∂–Ω–æ:** `boxes` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0 –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã, –Ω–æ `original_boxes` –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ!

### 4. generators/ - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

–¢—Ä–∏ –∫–ª–∞—Å—Å–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
- `InvoiceGenerator` - Commercial Invoice (11 –∫–æ–ª–æ–Ω–æ–∫)
- `SpecificationGenerator` - Specification (18 –∫–æ–ª–æ–Ω–æ–∫)
- `PackingListGenerator` - Packing List (11 –∫–æ–ª–æ–Ω–æ–∫)

**–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞ generate():**

1. **–°–æ–∑–¥–∞–Ω–∏–µ —à–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∞–¥—Ä–µ—Å –ø—Ä–æ–¥–∞–≤—Ü–∞
   - –¢–µ–ª–µ—Ñ–æ–Ω
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ
   - –ö–æ–Ω—Ç—Ä–∞–∫—Ç
   - –£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏
   - –ù–æ–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

2. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞)

3. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º `OutputLine`
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è" (–≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–∞—Ä—ã)
   - –ù—É–º–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫
   - –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ (Brand, Article) –¥–ª—è –≤—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–æ–∫

4. **–ü–æ–¥—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤:**
   - `total_qty`, `total_net`, `total_gross`
   - **–í–ê–ñ–ù–û:** `total_boxes` –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–æ–∫!
   - `total_amount`

5. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É—Ç–µ—Ä–∞:**
   - –°—Ç—Ä–æ–∫–∞ "Total / –ò—Ç–æ–≥–æ"
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å, —Å—Ç—Ä–∞–Ω–∞ –∏ —Ç.–¥.)
   - **–¢–æ–ª—å–∫–æ –¥–ª—è Specification:** –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è

6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel —á–µ—Ä–µ–∑ pandas**

7. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫ boxes** –¥–ª—è –ø–∞—Ä —Å—Ç—Ä–æ–∫:
```python
if is_continuation:
    ws.merge_cells(f'I{current_row-1}:I{current_row}')
    ws[f'I{current_row-1}'] = line.original_boxes
```

8. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä

### 5. formatters/ - –§–æ—Ä–º–∞—Ç—Ç–µ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

–¢—Ä–∏ –∫–ª–∞—Å—Å–∞ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- `InvoiceFormatter`
- `SpecificationFormatter`
- `PackingListFormatter`

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–ø–∫–∏ (—à—Ä–∏—Ñ—Ç—ã, —Ä–∞–∑–º–µ—Ä—ã, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ)
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (–≥—Ä–∞–Ω–∏—Ü—ã, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, —à—Ä–∏—Ñ—Ç—ã)
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É—Ç–µ—Ä–∞

**–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞ format():**

```python
def format(self, file_path: str, data_start_row: int, data_end_row: int):
    wb = load_workbook(file_path)
    ws = wb.active
    
    self._set_column_widths(ws)
    self._format_header(ws)
    self._format_table(ws, data_start_row, data_end_row)
    self._format_footer(ws, data_end_row)
    
    wb.save(file_path)
    wb.close()  # –í–ê–ñ–ù–û: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª!
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **–®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫:** –¢–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—É–Ω–∫—Ç–∞—Ö –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–∏
2. **–®—Ä–∏—Ñ—Ç—ã:** Arial —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ (9-16)
3. **–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ:**
   - –¶–µ–Ω—Ç—Ä –¥–ª—è –Ω–æ–º–µ—Ä–æ–≤, –∫–æ–¥–æ–≤, –∞—Ä—Ç–∏–∫—É–ª–æ–≤
   - –í–ª–µ–≤–æ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏–π
   - –í–ø—Ä–∞–≤–æ –¥–ª—è —á–∏—Å–µ–ª
4. **–ì—Ä–∞–Ω–∏—Ü—ã:** –¢–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ –¥–ª—è –≤—Å–µ—Ö —è—á–µ–µ–∫ —Ç–∞–±–ª–∏—Ü—ã
5. **–í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ

### 6. km_loader.py - –ó–∞–≥—Ä—É–∑—á–∏–∫ –∫–æ–¥–æ–≤ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ "–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫"

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥—É–ª—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≥—Ä—É–∑–æ–∫ –ö–ú (–∫–æ–¥–æ–≤ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏) –∏–∑ —Å–∏—Å—Ç–µ–º—ã "–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫" –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
1. **–ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤ –≤—ã–≥—Ä—É–∑–∫–∏** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤** - —É–¥–∞–ª–µ–Ω–∏–µ —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤ (PRG, BOX –∏ —Ç.–ø.)
3. **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ `(–∞—Ä—Ç–∏–∫—É–ª, —Ä–∞–∑–º–µ—Ä) ‚Üí [–ö–ú –∫–æ–¥—ã]`
4. **–ü–æ–∏—Å–∫ –∫–æ–¥–æ–≤** - –ø–æ–ª—É—á–µ–Ω–∏–µ –ö–ú –∫–æ–¥–æ–≤ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ç–µ–ª—å–∫–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞ KMLoader:**

```python
class KMLoader:
    def __init__(self, file_path: str):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤—ã–≥—Ä—É–∑–∫–∏ –∏ —Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å"""
        self.file_path = Path(file_path)
        self._index: Dict[Tuple[str, int], List[str]] = {}
        self._load()

    def _normalize_article(self, article: str) -> str:
        """–£–±–∏—Ä–∞–µ—Ç —Å—É—Ñ—Ñ–∏–∫—Å—ã —Ç–∏–ø–∞ ' PRG', ' BOX' –∏–∑ –∞—Ä—Ç–∏–∫—É–ª–∞"""
        # GL24136-1 PRG -> GL24136-1

    def _extract_article(self, nomenclature: str) -> Optional[str]:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∞—Ä—Ç–∏–∫—É–ª –∏–∑ —Å—Ç—Ä–æ–∫–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã.

        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
        - '–¢—É—Ñ–ª–∏ –∂–µ–Ω—Å–∫–∏–µ –∞—Ä—Ç.GL24136-1(...)' -> 'GL24136-1'
        - '–ë–æ—Ç–∏–Ω–∫–∏ –∞—Ä—Ç.A226C3305-7-1(...)' -> 'A226C3305-7-1'
        - '–¢—É—Ñ–ª–∏ –∞—Ä—Ç.CA23C1030-153(...)' -> 'CA23C1030-153'

        –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
        - –°—Ç–∞—Ä—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤: GL24136-1, BF25086-1
        - –ù–æ–≤—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤: A226C3305-7-1, CA23C1030-153
        """

    def get_km_codes(self, article: str, sizes: List[int]) -> List[str]:
        """–ü–æ–ª—É—á–∞–µ—Ç –ö–ú –∫–æ–¥—ã –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º"""

    def get_km_codes_for_category(self, article: str, insole_category: str) -> List[str]:
        """–ü–æ–ª—É—á–∞–µ—Ç –ö–ú –∫–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ç–µ–ª—å–∫–∏ (‚â§24—Å–º / >24—Å–º)"""
```

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –≤—ã–≥—Ä—É–∑–∫–∏:**

| –ö–æ–ª–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|--------|----------|
| A | –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ | `–¢—É—Ñ–ª–∏ –∂–µ–Ω—Å–∫–∏–µ –∞—Ä—Ç.GL24136-1(–Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –∫–æ–∂–∞)` | –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å –∞—Ä—Ç–∏–∫—É–ª–æ–º |
| B | –†–∞–∑–º–µ—Ä | `36` | –†–∞–∑–º–µ—Ä –æ–±—É–≤–∏ |
| C | GTIN | `4630083360812` | Global Trade Item Number |
| D | –ö–ú | `0104630083360812215_ijUKGGz/gsJ` | –ö–æ–¥ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ |

**–õ–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤:**

```python
# –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π
r'–∞—Ä—Ç\.[\s\W]*([A-Z0-9][A-Z0-9\-]+?)(?:\s*[\(,]|\s+[–ê-–Ø])'

# –ü—Ä–∏–º–µ—Ä—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:
"–¢—É—Ñ–ª–∏ –∂–µ–Ω—Å–∫–∏–µ –∞—Ä—Ç.GL24136-1(–Ω–∞—Ç. –∫–æ–∂–∞)" -> "GL24136-1"
"–ë–æ—Ç–∏–Ω–∫–∏ –∞—Ä—Ç.A226C3305-7-1(—á–µ—Ä–Ω–∞—è)" -> "A226C3305-7-1"
"–¢—É—Ñ–ª–∏ –∞—Ä—Ç.CA23C1030-153(–∫–æ–∂–∞)" -> "CA23C1030-153"
"–¢—É—Ñ–ª–∏ –∞—Ä—Ç.–°BF25086-1(—Å–µ—Ä—ã–π)" -> "BF25086-1"  # –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –°
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ run.py:**

```python
# –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ ShusteriAutomation:

def get_km_files(self):
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ '–≤—ã–≥—Ä—É–∑–∫–∞ —á–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫'"""

def select_km_file(self):
    """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏"""
    # üè∑Ô∏è  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ (–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫)? [y/n]

def enrich_with_km_codes(self, output_lines, km_loader: KMLoader):
    """–û–±–æ–≥–∞—â–∞–µ—Ç output_lines –∫–æ–¥–∞–º–∏ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏"""
    for line in output_lines:
        km_codes = km_loader.get_km_codes_for_category(
            line.article,
            line.insole_category
        )
        if km_codes:
            line.kiz_codes = km_codes
```

**–ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –ö–ú –∫–æ–¥–∞–º–∏:**

```
1. –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ –ö–ú (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ‚îî‚îÄ> –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –∏–∑ –ø–∞–ø–∫–∏ "–≤—ã–≥—Ä—É–∑–∫–∞ —á–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫/"

2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
   ‚îî‚îÄ> KMLoader –ø–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª –∏ —Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å

3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   ‚îî‚îÄ> –û–±—ã—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (parser -> processor -> output_lines)

4. –û–±–æ–≥–∞—â–µ–Ω–∏–µ –ö–ú –∫–æ–¥–∞–º–∏
   ‚îî‚îÄ> –î–ª—è –∫–∞–∂–¥–æ–π OutputLine:
       - –ë–µ—Ä—ë–º –∞—Ä—Ç–∏–∫—É–ª (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π)
       - –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø–æ insole_category (‚â§24—Å–º = [35,36,37])
       - –ü–æ–ª—É—á–∞–µ–º –ö–ú –∫–æ–¥—ã –∏–∑ –∏–Ω–¥–µ–∫—Å–∞
       - –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ line.kiz_codes

5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   ‚îî‚îÄ> Specification: –∫–æ–ª–æ–Ω–∫–∞ –ö–ò–ó (R)
       - –ö–æ–¥—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ (\n)
       - –ö–∞–∂–¥—ã–π –∫–æ–¥ –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ –≤–Ω—É—Ç—Ä–∏ —è—á–µ–π–∫–∏
```

**–ü—Ä–∏–º–µ—Ä –æ–±–æ–≥–∞—â–µ–Ω–∏—è:**

```python
# –í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
output_line = OutputLine(
    article="GL24136-1",
    insole_category="–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º",  # —Ä–∞–∑–º–µ—Ä—ã 35-37
    quantity=45,
    ...
)

# –ü–æ—Å–ª–µ –æ–±–æ–≥–∞—â–µ–Ω–∏—è
km_codes = km_loader.get_km_codes_for_category("GL24136-1", "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º")
# ‚Üí ['0104630083369471215...', '0104630083360812215...', ...]  (35 –∫–æ–¥–æ–≤)

output_line.kiz_codes = km_codes

# –í Specification (–∫–æ–ª–æ–Ω–∫–∞ R):
cell_value = '\n'.join(km_codes)
# –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Excel:
# 0104630083369471215dbn9ieddgTn-
# 0104630083360812215_ijUKGGz/gsJ
# 0104630083360812215*6zCRuqR5SQQ
# ... (–∫–∞–∂–¥—ã–π –∫–æ–¥ –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤:**
   - `GL24136-1 PRG` ‚Üí `GL24136-1` (—É–±–∏—Ä–∞–µ—Ç—Å—è —Å—É—Ñ—Ñ–∏–∫—Å —É–ø–∞–∫–æ–≤–∫–∏)
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –ö–ú –∫–æ–¥—ã –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏

2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤: `GL24136-1`, `BF25086-1`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤: `A226C3305-7-1`, `CA23C1030-153`
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∞—Ä—Ç–∏–∫—É–ª–∞—Ö

3. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ç–µ–ª—å–∫–∏:**
   - `‚â§24—Å–º` ‚Üí —Ä–∞–∑–º–µ—Ä—ã [35, 36, 37]
   - `>24—Å–º` ‚Üí —Ä–∞–∑–º–µ—Ä—ã [38, 39, 40, 41]

4. **–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**
   - –ö–ú –∫–æ–¥—ã —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏ `\n`
   - Excel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç Wrap Text
   - –ö–∞–∂–¥—ã–π –∫–æ–¥ –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.yaml - –û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
# –¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è EU —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –¥–ª–∏–Ω—ã —Å—Ç–µ–ª—å–∫–∏
size_to_insole:
  "35": 22.5
  "36": 23.0
  "37": 24.0
  "38": 24.5
  "39": 25.0
  "40": 25.5
  "41": 26.0
  "42": 26.5

# –ì—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
insole_boundary: 24.0

# –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
input_columns:
  article: "–ê–†–¢–ò–ö–£–õ"
  size_range: "–†–ê–ó–ú–ï–†"
  brand: "–ú–ê–†–ö–ê"
  code: "–ö–û–î"
  name: "–ù–ê–ò–ú–ï–ù–û–í–ê–ù–ò–ï"
  material: "–ú–ê–¢–ï–†–ò–ê–õ –í–ï–†–•–ê"
  color: "–¶–í–ï–¢"
  lining: "–ü–û–î–ö–õ–ê–î–ö–ê"
  sole: "–ü–û–î–û–®–í–ê"
  heel_height: "–í—ã—Å–æ—Ç–∞ –∫–∞–±–ª—É–∫–∞"
  price: "–¶–ï–ù–ê"
  boxes: "–ö–û–†–û–ë–ö–ò –ó–ê–ì–†–£–ñ–ï–ù–´"
  net_weight_per_pair: "–í–ï–° –ù–ï–¢–¢–û –ù–ê –ü–ê–†"
  gross_weight_per_box: "–í–ï–° –ë–†–£–¢–¢–û –ó–ê –ö–û–†–û–ë–ö–£"
  composition: "–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Å–æ—Å—Ç–∞–≤"
  qty_35: "–∫–æ–ª.35 —Ä–∞–∑–º–µ—Ä"
  qty_36: "–∫–æ–ª.36 —Ä–∞–∑–º–µ—Ä"
  # ... –∏ —Ç.–¥. –¥–æ 42 —Ä–∞–∑–º–µ—Ä–∞
```

### –ü—Ä–µ—Å–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ (presets/*.yaml)

–ü—Ä–µ—Å–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞:

```yaml
preset_name: "–ö–ª–∏–µ–Ω—Ç 1"
description: "–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞"

seller:
  name: "–û–û–û –†–û–ú–ê–®–ö–ê"
  name_en: "ROMASHKA LLC"
  address: "–ê–¥—Ä–µ—Å –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º"
  address_en: "Seller address in English"
  phone: "+7 123 456 78 90"

buyer:
  name: "–û–û–û –ü–û–ö–£–ü–ê–¢–ï–õ–¨"
  address: "–ê–¥—Ä–µ—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º"
  address_en: "Buyer address in English"

contract:
  number: "12345/2024"
  date: "01.01.2024"

delivery:
  terms: "FCA Guangzhou"
  currency: "CNY"
  country_of_origin: "–ö–∏—Ç–∞–π"
  country_of_origin_en: "China"
```

---

## –§–æ—Ä–º–∞—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### 1. Commercial Invoice (11 –∫–æ–ª–æ–Ω–æ–∫)

| ‚Ññ | Brand | Code | Factory code | Description | Qty | Net | Gross | Boxes | Price | Amount |
|---|-------|------|--------------|-------------|-----|-----|-------|-------|-------|--------|

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–µ—Ç Terms of delivery –≤ —Ñ—É—Ç–µ—Ä–µ (—Ç–æ–ª—å–∫–æ –≤ —à–∞–ø–∫–µ)
- –ù–µ—Ç –ø–æ–¥–ø–∏—Å–µ–π
- Boxes –≤ –∫–æ–ª–æ–Ω–∫–µ I

### 2. Specification (18 –∫–æ–ª–æ–Ω–æ–∫)

| ‚Ññ | Brand | Code | Factory code | Description | Color | Material | Lining | Sole | Heel | Insole | Qty | Net | Gross | Boxes | Price | Amount | KIZ |
|---|-------|------|--------------|-------------|-------|----------|--------|------|------|--------|-----|-----|-------|-------|-------|--------|-----|

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –°–∞–º—ã–π —à–∏—Ä–æ–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç (18 –∫–æ–ª–æ–Ω–æ–∫)
- –ï—Å—Ç—å Terms of delivery –≤ —Ñ—É—Ç–µ—Ä–µ
- –ï—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
- Boxes –≤ –∫–æ–ª–æ–Ω–∫–µ O

### 3. Packing List (11 –∫–æ–ª–æ–Ω–æ–∫)

| ‚Ññ | Brand | Code | Factory code | Description | Color | Qty | Net | Gross | Boxes | Type |
|---|-------|------|--------------|-------------|-------|-----|-----|-------|-------|------|

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ï—Å—Ç—å –∫–æ–ª–æ–Ω–∫–∞ "Type of packaging" (–∫–∞—Ä—Ç–æ–Ω–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞)
- –ù–µ—Ç —Ü–µ–Ω –∏ —Å—É–º–º
- Boxes –≤ –∫–æ–ª–æ–Ω–∫–µ J

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ Excel

**–ü—Ä–æ–±–ª–µ–º–∞:** Windows –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã Excel –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É–µ–º context manager:
with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
    df.to_excel(writer, index=False, header=False)

# –ü–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã —Å openpyxl:
wb.save(file_path)
wb.close()  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!
```

### 2. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫ boxes –¥–ª—è –ø–∞—Ä–Ω—ã—Ö —Å—Ç—Ä–æ–∫

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```python
prev_line = None
current_row = data_start_row

for line in lines:
    is_continuation = (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ...)
    
    if is_continuation:
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–æ–π
        ws.merge_cells(f'I{current_row-1}:I{current_row}')  # –∏–ª–∏ J, –∏–ª–∏ O
        ws[f'I{current_row-1}'] = line.original_boxes  # ‚Üê –ö–õ–Æ–ß!
    elif line.boxes > 0:
        # –û–±—ã—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
        ws[f'I{current_row}'] = line.boxes
    
    current_row += 1
    prev_line = line
```

### 3. –ü–æ–¥—Å—á–µ—Ç total_boxes

**–í–ê–ñ–ù–û:** –ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–æ–±–∫–∏ –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã!

```python
for line in lines:
    is_continuation = (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ...)
    
    total_qty += line.quantity
    total_net += line.net_weight
    total_gross += line.gross_weight
    
    # –ö–†–ò–¢–ò–ß–ù–û:
    if not is_continuation:
        total_boxes += line.boxes  # –¢–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏!
    
    total_amount += line.amount
```

### 4. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É–º–º

```python
# CNY —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ –≤–º–µ—Å—Ç–æ –∑–∞–ø—è—Ç—ã—Ö:
f"¬•{total_amount:,.2f}".replace(',', ' ')

# –í–µ—Å–∞ —Å 3 –∑–Ω–∞–∫–∞–º–∏:
round(float(total_net), 3)
```

### 5. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π CLI

```python
from rich.console import Console
from rich.prompt import Prompt, Confirm
from rich.table import Table

console = Console()

# –¢–∞–±–ª–∏—Ü–∞ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
table = Table(show_header=True, header_style="bold magenta")
table.add_column("‚Ññ", style="cyan")
table.add_column("–ö–ª–∏–µ–Ω—Ç", style="green")
console.print(table)

# –í—ã–±–æ—Ä
choice = Prompt.ask("–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ—Å–µ—Ç", choices=["1", "2", "3"])

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
if Confirm.ask("–°–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç?", default=False):
    # ...
```

---

## –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ Excel

| –ê–†–¢–ò–ö–£–õ | –†–ê–ó–ú–ï–† | –ú–ê–†–ö–ê | –ö–û–î | –ù–ê–ò–ú–ï–ù–û–í–ê–ù–ò–ï | –ú–ê–¢–ï–†–ò–ê–õ –í–ï–†–•–ê | –¶–í–ï–¢ | ... | –∫–æ–ª.35 —Ä–∞–∑–º–µ—Ä | –∫–æ–ª.36 —Ä–∞–∑–º–µ—Ä | ... |
|---------|--------|-------|-----|--------------|----------------|------|-----|---------------|---------------|-----|
| 998089/05-01 | 35-39 | BETSY | 6403911100/6403911800 | –ë–æ—Ç–∏–Ω–∫–∏ –∂–µ–Ω—Å–∫–∏–µ | –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –∫–æ–∂–∞ | —á–µ—Ä–Ω—ã–π | ... | 10 | 20 | ... |

### –ü—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

**–ü–æ—Å–ª–µ Parser:**
```python
ProductLine(
    article="998089/05-01",
    brand="BETSY",
    code_raw="6403911100/6403911800",
    hs_code_le24="6403911100",
    hs_code_gt24="6403911800",
    qty_by_size={35: 10, 36: 20, 37: 15, 38: 25, 39: 30},
    total_pairs=100,
    pairs_le24=45,  # 10+20+15
    pairs_gt24=55,  # 25+30
    boxes=10,
    # ...
)
```

**–ü–æ—Å–ª–µ Processor (2 —Å—Ç—Ä–æ–∫–∏, —Ç.–∫. –∫–æ–¥—ã —Ä–∞–∑–Ω—ã–µ):**
```python
# –°—Ç—Ä–æ–∫–∞ 1:
OutputLine(
    article="998089/05-01",
    hs_code="6403911100",
    insole_category="–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º",
    quantity=45,
    boxes=10,
    original_boxes=10,
    # ...
)

# –°—Ç—Ä–æ–∫–∞ 2:
OutputLine(
    article="998089/05-01",
    hs_code="6403911800",
    insole_category="–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –±–æ–ª–µ–µ 24—Å–º",
    quantity=55,
    boxes=0,  # ‚Üê –í–ê–ñ–ù–û!
    original_boxes=10,  # ‚Üê –í–ê–ñ–ù–û!
    # ...
)
```

**–í –¥–æ–∫—É–º–µ–Ω—Ç–µ Invoice:**
```
‚Ññ ‚îÇ Brand ‚îÇ Code       ‚îÇ Article      ‚îÇ Description              ‚îÇ Qty ‚îÇ ... ‚îÇ Boxes ‚îÇ
1 ‚îÇ BETSY ‚îÇ 6403911100 ‚îÇ 998089/05-01 ‚îÇ ..., –¥–æ 24—Å–º             ‚îÇ 45  ‚îÇ ... ‚îÇ       ‚îÇ
  ‚îÇ       ‚îÇ 6403911800 ‚îÇ              ‚îÇ ..., –±–æ–ª–µ–µ 24—Å–º          ‚îÇ 55  ‚îÇ ... ‚îÇ  10   ‚îÇ
                                                                          ‚îÇ   ‚Üë   ‚îÇ
                                                                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                                        –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã
```

### –ü—Ä–∏–º–µ—Ä —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–æ–¥–∞–º–∏

**–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:**
```
–ê–†–¢–ò–ö–£–õ: "ABC123"
–ö–û–î: "6403911100"  ‚Üê –ë–ï–ó —Å–ª—ç—à–∞! (–æ–¥–∏–Ω –∫–æ–¥)
–†–∞–∑–º–µ—Ä—ã: 35(10), 36(20), 37(15), 38(25), 39(30)
```

**–ü–æ—Å–ª–µ Processor (1 —Å—Ç—Ä–æ–∫–∞):**
```python
OutputLine(
    article="ABC123",
    hs_code="6403911100",  # –æ–¥–∏–Ω –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö
    insole_category="–≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã 35-39",  # –ù–ï "–¥–æ/–±–æ–ª–µ–µ 24—Å–º"!
    quantity=100,  # –≤—Å–µ –ø–∞—Ä—ã –≤–º–µ—Å—Ç–µ
    boxes=10,
    # ...
)
```

**–í –¥–æ–∫—É–º–µ–Ω—Ç–µ:**
```
‚Ññ ‚îÇ Brand ‚îÇ Code       ‚îÇ Article ‚îÇ Description           ‚îÇ Qty ‚îÇ ... ‚îÇ Boxes ‚îÇ
1 ‚îÇ BETSY ‚îÇ 6403911100 ‚îÇ ABC123  ‚îÇ ..., –≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã 35-39‚îÇ 100 ‚îÇ ... ‚îÇ  10   ‚îÇ
```

---

## –ó–∞–ø—É—Å–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
```bash
python run.py
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
```
1. –í—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ (–∏–∑ presets/)
2. –í—ã–±–æ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–∏–∑ input/)
3. –í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞ –∏–Ω–≤–æ–π—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: YYYYMMDD01)
4. –í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–≤–æ–¥–∞:
   - 1: –¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞
   - 2: –û–¥–∏–Ω —Ñ–∞–π–ª —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏
6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
7. –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
8. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
```
output/
‚îú‚îÄ‚îÄ Shusteri_2024010101_20240101_Invoice.xlsx
‚îú‚îÄ‚îÄ Shusteri_2024010101_20240101_Specification.xlsx
‚îî‚îÄ‚îÄ Shusteri_2024010101_20240101_PackingList.xlsx

–ò–õ–ò

output/
‚îî‚îÄ‚îÄ Shusteri_2024010101_20240101_All.xlsx  (3 –ª–∏—Å—Ç–∞)
```

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –ò–ò

### ‚ö†Ô∏è –í–ê–ñ–ù–û –ø–æ–Ω–∏–º–∞—Ç—å:

1. **–õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–¥–æ–≤ –¢–ù –í–≠–î:**
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Üí 1 —Å—Ç—Ä–æ–∫–∞
   - –†–∞–∑–Ω—ã–µ ‚Üí 2 —Å—Ç—Ä–æ–∫–∏

2. **Boxes —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –ø–∞—Ä—ã:**
   - –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞: boxes=0, –Ω–æ original_boxes=N
   - –Ø—á–µ–π–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ

3. **Total boxes —Å—á–∏—Ç–∞–µ—Ç—Å—è –ë–ï–ó –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º is_continuation –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º

4. **–§–∞–π–ª—ã –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å:**
   - wb.close() –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

5. **Specification –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –¥—Ä—É–≥–∏—Ö:**
   - 18 –∫–æ–ª–æ–Ω–æ–∫ –≤–º–µ—Å—Ç–æ 11
   - –° Terms of delivery –≤ —Ñ—É—Ç–µ—Ä–µ
   - –° –ø–æ–¥–ø–∏—Å—è–º–∏

6. **–ù—É–º–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–æ–∫:**
   - –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–∞—Ä—ã –Ω–µ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä–∞
   - Brand, Article —Ç–æ–∂–µ –ø—É—Å—Ç—ã–µ –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
   - –í–∞–ª–∏–¥–∞—Ü–∏—è HS –∫–æ–¥–æ–≤ (10 —Ü–∏—Ñ—Ä)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Å–æ–≤ (net < gross)

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è processor.py
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - –¢–µ—Å—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
   - Try-catch –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - Rollback –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–æ–≤

5. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö –≤–∞–ª—é—Ç
   - –ë–æ–ª—å—à–µ —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
   - Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

**–ö–æ–Ω–µ—Ü —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

_–í–µ—Ä—Å–∏—è: 1.0_  
_–î–∞—Ç–∞: 2025-01-16_  
_–ê–≤—Ç–æ—Ä: –†–æ—Å—Ç–∏—Å–ª–∞–≤ (Shusteri Automation Project)_

---
---
---

## üíª –ß–ê–°–¢–¨ 2: –ü–û–õ–ù–´–ô –ò–°–•–û–î–ù–´–ô –ö–û–î –ü–†–û–ï–ö–¢–ê

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
shusteri-automation/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ parser.py
‚îÇ   ‚îú‚îÄ‚îÄ processor.py
‚îÇ   ‚îú‚îÄ‚îÄ generators/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ invoice.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ specification.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ packing_list.py
‚îÇ   ‚îî‚îÄ‚îÄ formatters/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ invoice_formatter.py
‚îÇ       ‚îú‚îÄ‚îÄ specification_formatter.py
‚îÇ       ‚îî‚îÄ‚îÄ packing_list_formatter.py
‚îú‚îÄ‚îÄ config.yaml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ run.py
```

---

### üìÑ –§–∞–π–ª: `config.yaml`

```yaml
# ===========================================
# –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –î–õ–Ø –®–£–°–¢–ï–†–ò
# ===========================================
# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ä–∞–∑–º–µ—Ä—ã, –∫–æ–ª–æ–Ω–∫–∏)
# –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –ø–∞–ø–∫—É presets/

# –¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è EU —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –¥–ª–∏–Ω—ã —Å—Ç–µ–ª—å–∫–∏
size_to_insole:
  "35": 22.5
  "36": 23.0
  "37": 24.0
  "38": 24.5
  "39": 25.0
  "40": 25.5
  "41": 26.0
  "42": 26.5

# –ì—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å—Ç—Ä–æ–≥–æ)
insole_boundary: 24.0

# –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
input_columns:
  article: "–ê–†–¢–ò–ö–£–õ"
  size_range: "–†–ê–ó–ú–ï–†"
  brand: "–ú–ê–†–ö–ê"
  code: "–ö–û–î"
  name: "–ù–ê–ò–ú–ï–ù–û–í–ê–ù–ò–ï"
  material: "–ú–ê–¢–ï–†–ò–ê–õ –í–ï–†–•–ê"
  color: "–¶–í–ï–¢"
  lining: "–ü–û–î–ö–õ–ê–î–ö–ê"
  sole: "–ü–û–î–û–®–í–ê"
  heel_height: "–í—ã—Å–æ—Ç–∞ –∫–∞–±–ª—É–∫–∞"
  price: "–¶–ï–ù–ê"
  boxes: "–ö–û–†–û–ë–ö–ò –ó–ê–ì–†–£–ñ–ï–ù–´"
  net_weight_per_pair: "–í–ï–° –ù–ï–¢–¢–û –ù–ê –ü–ê–†"
  gross_weight_per_box: "–í–ï–° –ë–†–£–¢–¢–û –ó–ê –ö–û–†–û–ë–ö–£"
  composition: "–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Å–æ—Å—Ç–∞–≤"

  qty_35: "–∫–æ–ª.35 —Ä–∞–∑–º–µ—Ä"
  qty_36: "–∫–æ–ª.36 —Ä–∞–∑–º–µ—Ä"
  qty_37: "–∫–æ–ª.37 —Ä–∞–∑–º–µ—Ä"
  qty_38: "–∫–æ–ª.38 —Ä–∞–∑–º–µ—Ä"
  qty_39: "–∫–æ–ª.39 —Ä–∞–∑–º–µ—Ä"
  qty_40: "–∫–æ–ª.40 —Ä–∞–∑–º–µ—Ä"
  qty_41: "–∫–æ–ª.41 —Ä–∞–∑–º–µ—Ä"
  qty_42: "–∫–æ–ª.42 —Ä–∞–∑–º–µ—Ä"
```

---

### üìÑ –§–∞–π–ª: `requirements.txt`

```
pandas==2.1.4
openpyxl==3.1.2
xlsxwriter==3.1.9
click==8.1.7
rich==13.7.0
pydantic==2.5.0
PyYAML==6.0.1
```

---

### üìÑ –§–∞–π–ª: `README.md`

```markdown
# Shusteri Automation

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Invoice, Specification, Packing List) –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ Shusteri.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Invoice (–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –∏–Ω–≤–æ–π—Å)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Specification (–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Packing List (–£–ø–∞–∫–æ–≤–æ—á–Ω—ã–π –ª–∏—Å—Ç)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ—Å–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª–∏–Ω—ã —Å—Ç–µ–ª—å–∫–∏ (‚â§24—Å–º / >24—Å–º)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–µ—Å–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ `presets/`

3. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ Excel —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É `input/`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É:
```bash
python run.py
```

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
1. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ—Å–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞
4. –£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (3 —Ñ–∞–π–ª–∞ –∏–ª–∏ 1 —Ñ–∞–π–ª —Å 3 –ª–∏—Å—Ç–∞–º–∏)

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ `output/`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
shusteri-automation/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ generators/       # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ formatters/       # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ parser.py         # –ü–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ processor.py      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ presets/              # –ü—Ä–µ—Å–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ input/                # –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ output/               # –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ config.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ run.py                # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- pandas
- openpyxl
- rich
- pydantic
- PyYAML

## –õ–∏—Ü–µ–Ω–∑–∏—è

Proprietary
```

---

### üìÑ –§–∞–π–ª: `run.py`

```python
#!/usr/bin/env python3
"""
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞ –¥–ª—è –®—É—Å—Ç–µ—Ä–∏
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è Invoice, Specification –∏ Packing List —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
"""

import yaml
from pathlib import Path
from datetime import datetime
import logging
from rich.console import Console
from rich.table import Table
from rich.prompt import Prompt, Confirm

from src.parser import InputFileParser
from src.processor import DataProcessor
from src.generators.invoice import InvoiceGenerator
from src.generators.specification import SpecificationGenerator
from src.generators.packing_list import PackingListGenerator
from src.models import DocumentMetadata

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('automation.log', encoding='utf-8'),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

console = Console()


class ShusteriAutomation:
    """–ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏"""

    def __init__(self, config_path: str = "config.yaml"):
        with open(config_path, 'r', encoding='utf-8') as f:
            self.config = yaml.safe_load(f)
        
        self.preset = None  # –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ—Å–µ—Ç
    
    def get_available_presets(self):
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–µ—Å–µ—Ç–æ–≤"""
        presets_dir = Path("presets")
        if not presets_dir.exists():
            console.print("[bold red]‚ùå –ü–∞–ø–∫–∞ presets/ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞![/bold red]")
            console.print("[yellow]–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É presets/ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ —Ç—É–¥–∞ —Ñ–∞–π–ª—ã –ø—Ä–µ—Å–µ—Ç–æ–≤[/yellow]")
            return []
        
        # –ò—â–µ–º YAML —Ñ–∞–π–ª—ã
        preset_files = list(presets_dir.glob("*.yaml")) + list(presets_dir.glob("*.yml"))
        
        if not preset_files:
            console.print("[bold red]‚ùå –ù–µ—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ presets/![/bold red]")
            return []
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ—Å–µ—Ç–∞—Ö
        presets = []
        for preset_file in sorted(preset_files):
            try:
                with open(preset_file, 'r', encoding='utf-8') as f:
                    preset_data = yaml.safe_load(f)
                    presets.append({
                        'file': preset_file,
                        'name': preset_data.get('preset_name', preset_file.stem),
                        'description': preset_data.get('description', ''),
                        'data': preset_data
                    })
            except Exception as e:
                logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–µ—Å–µ—Ç {preset_file}: {e}")
        
        return presets
    
    def select_preset(self):
        """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞"""
        presets = self.get_available_presets()
        
        if not presets:
            return None
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–µ—Å–µ—Ç–æ–≤
        console.print("\n[bold cyan]üë• –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤:[/bold cyan]\n")
        
        table = Table(show_header=True, header_style="bold magenta")
        table.add_column("‚Ññ", style="cyan", width=4)
        table.add_column("–ö–ª–∏–µ–Ω—Ç", style="green")
        table.add_column("–û–ø–∏—Å–∞–Ω–∏–µ", style="yellow")
        
        for idx, preset in enumerate(presets, 1):
            table.add_row(
                str(idx),
                preset['name'],
                preset['description']
            )
        
        console.print(table)
        console.print()
        
        # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—ã–±–æ—Ä
        if len(presets) == 1:
            console.print(f"[green]‚úì –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞–Ω –ø—Ä–µ—Å–µ—Ç: {presets[0]['name']}[/green]\n")
            return presets[0]['data']
        else:
            choice = Prompt.ask(
                "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ—Å–µ—Ç (–≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä)",
                choices=[str(i) for i in range(1, len(presets) + 1)],
                default="1"
            )
            selected_preset = presets[int(choice) - 1]
            console.print(f"[green]‚úì –í—ã–±—Ä–∞–Ω –ø—Ä–µ—Å–µ—Ç: {selected_preset['name']}[/green]\n")
            return selected_preset['data']

    def get_input_files(self):
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ input/"""
        input_dir = Path("input")
        if not input_dir.exists():
            console.print("[bold red]‚ùå –ü–∞–ø–∫–∞ input/ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞![/bold red]")
            console.print("[yellow]–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É input/ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ —Ç—É–¥–∞ Excel —Ñ–∞–π–ª—ã[/yellow]")
            return []
        
        # –ò—â–µ–º Excel —Ñ–∞–π–ª—ã
        excel_files = list(input_dir.glob("*.xlsx")) + list(input_dir.glob("*.xls"))
        excel_files = [f for f in excel_files if not f.name.startswith('~')]  # –ò—Å–∫–ª—é—á–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
        
        return sorted(excel_files)

    def select_input_file(self):
        """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
        files = self.get_input_files()
        
        if not files:
            console.print("[bold red]‚ùå –ù–µ—Ç Excel —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ input/![/bold red]")
            console.print("[yellow]–ü–æ–ª–æ–∂–∏—Ç–µ Excel —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É input/ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–Ω–æ–≤–∞[/yellow]")
            return None
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
        console.print("\n[bold cyan]üìÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã:[/bold cyan]\n")
        
        table = Table(show_header=True, header_style="bold magenta")
        table.add_column("‚Ññ", style="cyan", width=4)
        table.add_column("–ò–º—è —Ñ–∞–π–ª–∞", style="green")
        table.add_column("–†–∞–∑–º–µ—Ä", style="yellow", justify="right")
        table.add_column("–î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è", style="blue")
        
        for idx, file in enumerate(files, 1):
            size_kb = file.stat().st_size / 1024
            mtime = datetime.fromtimestamp(file.stat().st_mtime).strftime('%d.%m.%Y %H:%M')
            table.add_row(str(idx), file.name, f"{size_kb:.1f} KB", mtime)
        
        console.print(table)
        console.print()
        
        # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—ã–±–æ—Ä
        if len(files) == 1:
            # –ï—Å–ª–∏ —Ñ–∞–π–ª –æ–¥–∏–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            console.print(f"[green]‚úì –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: {files[0].name}[/green]\n")
            return files[0]
        else:
            # –ï—Å–ª–∏ —Ñ–∞–π–ª–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ - –¥–∞–µ–º –≤—ã–±—Ä–∞—Ç—å
            choice = Prompt.ask(
                "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª (–≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä)",
                choices=[str(i) for i in range(1, len(files) + 1)],
                default="1"
            )
            selected_file = files[int(choice) - 1]
            console.print(f"[green]‚úì –í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: {selected_file.name}[/green]\n")
            return selected_file

    def get_invoice_number(self):
        """–ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ –∏–Ω–≤–æ–π—Å–∞"""
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        default_number = datetime.now().strftime('%Y%m%d01')
        
        invoice_number = Prompt.ask(
            "üìã –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞",
            default=default_number
        )
        
        return invoice_number

    def get_container_number(self):
        """–ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"""
        has_container = Confirm.ask(
            "üì¶ –ï—Å—Ç—å –Ω–æ–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞?",
            default=False
        )
        
        if has_container:
            container = Prompt.ask("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞")
            return container
        else:
            return ""
    
    def get_output_format(self):
        """–ó–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–≤–æ–¥–∞"""
        console.print("\n[cyan]üìÑ –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:[/cyan]")
        console.print("  [yellow]1[/yellow] - –¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞ (Invoice.xlsx, Specification.xlsx, PackingList.xlsx)")
        console.print("  [yellow]2[/yellow] - –û–¥–∏–Ω —Ñ–∞–π–ª —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏ (All_Documents.xlsx)")
        
        choice = Prompt.ask(
            "\n–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç",
            choices=["1", "2"],
            default="1"
        )
        
        return choice
    
    def generate_combined_file(
            self,
            lines,
            metadata,
            output_path,
            base_name
    ):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω —Ñ–∞–π–ª —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏"""
        from openpyxl import Workbook, load_workbook
        from copy import copy
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞
        temp_invoice = output_path / f"temp_invoice.xlsx"
        temp_spec = output_path / f"temp_spec.xlsx"
        temp_packing = output_path / f"temp_packing.xlsx"
        
        invoice_gen = InvoiceGenerator(self.config, self.preset)
        invoice_gen.generate(lines, metadata, str(temp_invoice))
        
        spec_gen = SpecificationGenerator(self.config, self.preset)
        spec_gen.generate(lines, metadata, str(temp_spec))
        
        packing_gen = PackingListGenerator(self.config, self.preset)
        packing_gen.generate(lines, metadata, str(temp_packing))
        
        # –°–æ–∑–¥–∞–µ–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
        combined_file = output_path / f"{base_name}_All.xlsx"
        wb_combined = Workbook()
        wb_combined.remove(wb_combined.active)  # –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç–æ–π –ª–∏—Å—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        # –ö–æ–ø–∏—Ä—É–µ–º –ª–∏—Å—Ç—ã –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        documents = [
            (temp_invoice, "Invoice"),
            (temp_spec, "Specification"),
            (temp_packing, "Packing List")
        ]
        
        for temp_file, sheet_name in documents:
            wb_temp = load_workbook(str(temp_file))
            source_ws = wb_temp.active
            
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ª–∏—Å—Ç –≤ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
            target_ws = wb_combined.create_sheet(title=sheet_name)
            
            # –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            for row in source_ws.iter_rows():
                for cell in row:
                    target_cell = target_ws[cell.coordinate]
                    target_cell.value = cell.value
                    if cell.has_style:
                        target_cell.font = copy(cell.font)
                        target_cell.border = copy(cell.border)
                        target_cell.fill = copy(cell.fill)
                        target_cell.number_format = copy(cell.number_format)
                        target_cell.protection = copy(cell.protection)
                        target_cell.alignment = copy(cell.alignment)
            
            # –ö–æ–ø–∏—Ä—É–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏
            for merged_cell_range in source_ws.merged_cells.ranges:
                target_ws.merge_cells(str(merged_cell_range))
            
            # –ö–æ–ø–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–ª–æ–Ω–æ–∫
            for col_letter, col_dim in source_ws.column_dimensions.items():
                target_ws.column_dimensions[col_letter].width = col_dim.width
            
            # –ö–æ–ø–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—ã —Å—Ç—Ä–æ–∫
            for row_num, row_dim in source_ws.row_dimensions.items():
                if row_dim.height:
                    target_ws.row_dimensions[row_num].height = row_dim.height
            
            wb_temp.close()
            temp_file.unlink()  # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
        wb_combined.save(str(combined_file))
        wb_combined.close()
        
        return combined_file

    def process(
            self,
            input_file: Path,
            invoice_number: str,
            container_number: str = "",
            output_format: str = "1",
            output_dir: str = "output"
    ):
        """–ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏"""

        console.print(f"\n[bold blue]üöÄ –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ Invoice #{invoice_number}[/bold blue]\n")

        try:
            # 1. –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
            console.print("[cyan]üì• –ß—Ç–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞...[/cyan]")
            parser = InputFileParser(self.config)
            products = parser.parse(str(input_file))

            if not products:
                console.print("[bold red]‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ[/bold red]")
                return

            console.print(f"[green]‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(products)} –ø–æ–∑–∏—Ü–∏–π[/green]\n")

            # 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            console.print("[cyan]‚öôÔ∏è  –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...[/cyan]")
            processor = DataProcessor(self.config)
            output_lines = processor.process(products)

            console.print(f"[green]‚úì –°–æ–∑–¥–∞–Ω–æ {len(output_lines)} —Å—Ç—Ä–æ–∫ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤[/green]\n")

            # 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
            date = datetime.now().strftime('%d.%m.%Y')
            metadata = DocumentMetadata(
                invoice_number=invoice_number,
                date=date,
                container_number=container_number,
                seller_name=self.preset['seller']['name'],
                seller_name_en=self.preset['seller'].get('name_en', ''),
                seller_address=self.preset['seller']['address'],
                seller_address_en=self.preset['seller'].get('address_en', ''),
                buyer_name=self.preset['buyer']['name'],
                buyer_address=self.preset['buyer']['address'],
                buyer_address_en=self.preset['buyer'].get('address_en', ''),
                contract_number=self.preset['contract']['number'],
                contract_date=self.preset['contract']['date'],
                terms_of_delivery=self.preset['delivery']['terms'],
                currency=self.preset['delivery']['currency']
            )

            # 4. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            output_path = Path(output_dir)
            output_path.mkdir(exist_ok=True)

            # –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
            base_name = f"Shusteri_{invoice_number}_{datetime.now().strftime('%Y%m%d')}"

            # 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
            console.print("[cyan]üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º...[/cyan]")

            if output_format == "1":
                # –¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞
                invoice_file = output_path / f"{base_name}_Invoice.xlsx"
                spec_file = output_path / f"{base_name}_Specification.xlsx"
                packing_file = output_path / f"{base_name}_PackingList.xlsx"

                invoice_gen = InvoiceGenerator(self.config, self.preset)
                invoice_gen.generate(output_lines, metadata, str(invoice_file))

                spec_gen = SpecificationGenerator(self.config, self.preset)
                spec_gen.generate(output_lines, metadata, str(spec_file))

                packing_gen = PackingListGenerator(self.config, self.preset)
                packing_gen.generate(output_lines, metadata, str(packing_file))
                
                generated_files = [
                    ("Invoice", invoice_file.name),
                    ("Specification", spec_file.name),
                    ("Packing List", packing_file.name)
                ]
            else:
                # –û–¥–∏–Ω —Ñ–∞–π–ª —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏
                combined_file = self.generate_combined_file(
                    output_lines,
                    metadata,
                    output_path,
                    base_name
                )
                
                generated_files = [
                    ("All Documents (3 sheets)", combined_file.name)
                ]

            console.print("[green]‚úì –î–æ–∫—É–º–µ–Ω—Ç—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º[/green]\n")

            # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            console.print(f"\n[bold green]‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ![/bold green]\n")

            result_table = Table(title="–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã")
            result_table.add_column("–î–æ–∫—É–º–µ–Ω—Ç", style="cyan")
            result_table.add_column("–§–∞–π–ª", style="green")

            for doc_name, file_name in generated_files:
                result_table.add_row(doc_name, file_name)

            console.print(result_table)

            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            total_qty = sum(line.quantity for line in output_lines)
            total_amount = sum(line.amount for line in output_lines)
            total_net = sum(line.net_weight for line in output_lines)
            total_gross = sum(line.gross_weight for line in output_lines)

            stats_table = Table(title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞")
            stats_table.add_column("–ü–∞—Ä–∞–º–µ—Ç—Ä", style="cyan")
            stats_table.add_column("–ó–Ω–∞—á–µ–Ω–∏–µ", style="magenta")

            stats_table.add_row("–í—Å–µ–≥–æ –ø–∞—Ä", str(total_qty))
            stats_table.add_row("–°—É–º–º–∞ (CNY)", f"¬•{total_amount:,.2f}")
            stats_table.add_row("–í–µ—Å –Ω–µ—Ç—Ç–æ (–∫–≥)", f"{total_net:,.3f}")
            stats_table.add_row("–í–µ—Å –±—Ä—É—Ç—Ç–æ (–∫–≥)", f"{total_gross:,.3f}")
            stats_table.add_row("–ü–æ–∑–∏—Ü–∏–π", str(len(products)))
            stats_table.add_row("–°—Ç—Ä–æ–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö", str(len(output_lines)))

            console.print(stats_table)

            console.print(f"\n[bold cyan]üìÅ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: {output_path.absolute()}[/bold cyan]\n")
            
            # –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç
            another = Confirm.ask("\nüí° –°–æ–∑–¥–∞—Ç—å –µ—â–µ –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç?", default=False)
            return another

        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}", exc_info=True)
            console.print(f"\n[bold red]üí• –û—à–∏–±–∫–∞: {e}[/bold red]\n")
            raise


def main():
    """
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
    """
    console.print("\n[bold blue]‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[/bold blue]")
    console.print("[bold blue]   Shusteri Automation - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤   [/bold blue]")
    console.print("[bold blue]‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê[/bold blue]\n")
    
    try:
        automation = ShusteriAutomation()
        
        # –í—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞
        preset = automation.select_preset()
        if not preset:
            console.print("[bold red]–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–±—Ä–∞—Ç—å –ø—Ä–µ—Å–µ—Ç. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã.[/bold red]")
            return
        
        automation.preset = preset
        
        # –¶–∏–∫–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        while True:
            # 1. –í—ã–±–æ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
            input_file = automation.select_input_file()
            if not input_file:
                break
            
            # 2. –ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ –∏–Ω–≤–æ–π—Å–∞
            invoice_number = automation.get_invoice_number()
            
            # 3. –ó–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            container_number = automation.get_container_number()
            
            # 4. –ó–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–≤–æ–¥–∞
            output_format = automation.get_output_format()
            
            # 5. –û–±—Ä–∞–±–æ—Ç–∫–∞
            create_another = automation.process(
                input_file,
                invoice_number,
                container_number,
                output_format
            )
            
            # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Ö–æ—á–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ—â–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã - –≤—ã—Ö–æ–¥–∏–º
            if not create_another:
                break
        
        console.print("\n[bold green]üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è![/bold green]\n")

    except KeyboardInterrupt:
        console.print("\n\n[yellow]‚ö†Ô∏è  –ü—Ä–µ—Ä–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º[/yellow]\n")
    except Exception as e:
        console.print(f"\n[bold red]üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}[/bold red]\n")
        exit(1)


if __name__ == "__main__":
    main()
```

---

### üìÑ –§–∞–π–ª: `src/models.py`

```python
"""
–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
"""
from pydantic import BaseModel, Field
from typing import Optional, List
from decimal import Decimal


class ProductLine(BaseModel):
    """–û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
    row_number: int
    brand: str
    article: str
    code_raw: str
    hs_code_le24: str = ""  # ‚â§24—Å–º
    hs_code_gt24: str = ""  # >24—Å–º
    name: str
    material: str
    color: str
    lining: str
    sole: str
    heel_height: str
    composition: Optional[str] = None
    price: Decimal
    boxes: int
    net_weight_per_pair: Decimal
    gross_weight_per_box: Decimal

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º
    qty_by_size: dict  # {35: 100, 36: 200, ...}

    @property
    def total_pairs(self) -> int:
        """–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä"""
        return sum(self.qty_by_size.values())

    @property
    def pairs_le24(self) -> int:
        """–ü–∞—Ä—ã ‚â§24—Å–º (—Ä–∞–∑–º–µ—Ä—ã 35-37)"""
        return sum(qty for size, qty in self.qty_by_size.items()
                   if size in [35, 36, 37])

    @property
    def pairs_gt24(self) -> int:
        """–ü–∞—Ä—ã >24—Å–º (—Ä–∞–∑–º–µ—Ä—ã 38+)"""
        return sum(qty for size, qty in self.qty_by_size.items()
                   if size in [38, 39, 40, 41, 42])


class OutputLine(BaseModel):
    """–°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""
    brand: str
    hs_code: str
    article: str
    description: str
    color: str
    material: str
    lining: str
    sole: str
    heel_height: str
    insole_category: str  # "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º" –∏–ª–∏ "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –±–æ–ª–µ–µ 24—Å–º"
    quantity: int
    net_weight: Decimal
    gross_weight: Decimal
    boxes: int
    original_boxes: int = 0
    price: Decimal
    amount: Decimal
    kiz_codes: List[str] = []


class DocumentMetadata(BaseModel):
    """–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    invoice_number: str
    date: str
    container_number: str = ""
    seller_name: str
    seller_name_en: str = ""
    seller_address: str
    seller_address_en: str = ""
    buyer_name: str
    buyer_address: str
    buyer_address_en: str = ""
    contract_number: str
    contract_date: str
    terms_of_delivery: str
    currency: str = "CNY"
```

---

### üìÑ –§–∞–π–ª: `src/parser.py`

```python
"""
–ü–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
"""
import pandas as pd
from typing import List, Tuple
from decimal import Decimal
from .models import ProductLine
import logging

logger = logging.getLogger(__name__)


class InputFileParser:
    """–ü–∞—Ä—Å–µ—Ä –∫–∏—Ç–∞–π—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã"""

    def __init__(self, config: dict):
        self.config = config
        self.columns = config['input_columns']

    def parse(self, file_path: str) -> List[ProductLine]:
        """–ß–∏—Ç–∞–µ—Ç –∏ –ø–∞—Ä—Å–∏—Ç –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª"""

        # –ß–∏—Ç–∞–µ–º Excel
        df = pd.read_excel(file_path, sheet_name=0)

        # –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∏—Ç–æ–≥–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
        df = df[df[self.columns['article']].notna()]
        df = df[df[self.columns['article']] != '']

        products = []

        for idx, row in df.iterrows():
            try:
                # –ü–∞—Ä—Å–∏–º –∫–æ–¥ (—Ñ–æ—Ä–º–∞—Ç: 6403911100/6403911800)
                code_raw = str(row[self.columns['code']])
                hs_le24, hs_gt24 = self._parse_hs_code(code_raw)

                # –°–æ–±–∏—Ä–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º
                qty_by_size = {}
                for size in [35, 36, 37, 38, 39, 40, 41, 42]:
                    col_name = self.columns.get(f'qty_{size}')
                    if col_name and col_name in row and pd.notna(row[col_name]):
                        qty = int(row[col_name])
                        if qty > 0:
                            qty_by_size[size] = qty

                if not qty_by_size:
                    logger.warning(f"–°—Ç—Ä–æ–∫–∞ {idx + 2}: –Ω–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                    continue

                product = ProductLine(
                    row_number=idx + 2,
                    brand=str(row[self.columns['brand']]),
                    article=str(row[self.columns['article']]),
                    code_raw=code_raw,
                    hs_code_le24=hs_le24,
                    hs_code_gt24=hs_gt24,
                    name=str(row[self.columns['name']]),
                    material=str(row[self.columns['material']]),
                    color=str(row[self.columns['color']]),
                    lining=str(row[self.columns['lining']]),
                    sole=str(row[self.columns['sole']]),
                    heel_height=str(row[self.columns['heel_height']]),
                    composition=str(row[self.columns['composition']]) if pd.notna(
                        row.get(self.columns['composition'])) else None,
                    price=Decimal(str(row[self.columns['price']])),
                    boxes=int(row[self.columns['boxes']]),
                    net_weight_per_pair=Decimal(str(row[self.columns['net_weight_per_pair']])),
                    gross_weight_per_box=Decimal(str(row[self.columns['gross_weight_per_box']])),
                    qty_by_size=qty_by_size
                )

                products.append(product)
                logger.info(f"‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å—Ç—Ä–æ–∫–∞ {idx + 2}: {product.article} ({product.total_pairs} –ø–∞—Ä)")

            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ {idx + 2}: {e}")
                continue

        logger.info(f"–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(products)} –ø–æ–∑–∏—Ü–∏–π")
        return products

    def _parse_hs_code(self, code_raw: str) -> Tuple[str, str]:
        """
        –†–∞–∑–¥–µ–ª—è–µ—Ç –∫–æ–¥ –≤–∏–¥–∞ 6403911100/6403911800
        Returns: (–∫–æ–¥ –¥–ª—è ‚â§24—Å–º, –∫–æ–¥ –¥–ª—è >24—Å–º)
        """
        if '/' in code_raw:
            parts = code_raw.split('/')
            return parts[0].strip(), parts[1].strip()
        else:
            # –ï—Å–ª–∏ —Å–ª—ç—à–∞ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω –∫–æ–¥ –¥–ª—è –æ–±–µ–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            return code_raw.strip(), code_raw.strip()
```

---

### üìÑ –§–∞–π–ª: `src/processor.py`

```python
"""
–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞–Ω–Ω—ã—Ö - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
"""
from typing import List
from decimal import Decimal
from .models import ProductLine, OutputLine


class DataProcessor:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö"""

    def __init__(self, config: dict):
        self.config = config

    def process(self, products: List[ProductLine]) -> List[OutputLine]:
        """
        –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ
        
        –õ–æ–≥–∏–∫–∞:
        - –ï—Å–ª–∏ –∫–æ–¥—ã –¢–ù –í–≠–î –†–ê–ó–ù–´–ï (–µ—Å—Ç—å —Å–ª—ç—à –≤–æ –≤—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ) ‚Üí —Å–æ–∑–¥–∞–µ–º –î–í–ï —Å—Ç—Ä–æ–∫–∏: –¥–ª—è ‚â§24—Å–º –∏ >24—Å–º
        - –ï—Å–ª–∏ –∫–æ–¥—ã –¢–ù –í–≠–î –û–î–ò–ù–ê–ö–û–í–´–ï (–Ω–µ—Ç —Å–ª—ç—à–∞ –≤–æ –≤—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ) ‚Üí —Å–æ–∑–¥–∞–µ–º –û–î–ù–£ —Å—Ç—Ä–æ–∫—É —Å–æ –≤—Å–µ–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
        """
        output_lines = []

        for product in products:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ª–∏ –∫–æ–¥—ã –¢–ù –í–≠–î
            codes_are_same = (product.hs_code_le24 == product.hs_code_gt24)
            
            if codes_are_same:
                # –ï—Å–ª–∏ –∫–æ–¥ –æ–¥–∏–Ω - —Å–æ–∑–¥–∞–µ–º –û–î–ù–£ —Å—Ç—Ä–æ–∫—É —Å–æ –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏
                if product.total_pairs > 0:
                    output_lines.append(self._create_output_line(
                        product,
                        category="all",  # –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –≤–º–µ—Å—Ç–µ
                        quantity=product.total_pairs
                    ))
            else:
                # –ï—Å–ª–∏ –∫–æ–¥—ã —Ä–∞–∑–Ω—ã–µ - —Å–æ–∑–¥–∞–µ–º –î–í–ï —Å—Ç—Ä–æ–∫–∏ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
                
                # –°—Ç—Ä–æ–∫–∞ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚â§24—Å–º
                if product.pairs_le24 > 0:
                    output_lines.append(self._create_output_line(
                        product,
                        category="le24",
                        quantity=product.pairs_le24
                    ))

                # –°—Ç—Ä–æ–∫–∞ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ >24—Å–º
                if product.pairs_gt24 > 0:
                    output_lines.append(self._create_output_line(
                        product,
                        category="gt24",
                        quantity=product.pairs_gt24
                    ))

        return output_lines

    def _create_output_line(
            self,
            product: ProductLine,
            category: str,
            quantity: int
    ) -> OutputLine:
        """–°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞"""

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º HS –∫–æ–¥ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        if category == "le24":
            hs_code = product.hs_code_le24
            insole_text = "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –¥–æ 24—Å–º"
        elif category == "gt24":
            hs_code = product.hs_code_gt24
            insole_text = "–¥–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏ –±–æ–ª–µ–µ 24—Å–º"
        else:  # category == "all"
            # –ï—Å–ª–∏ –∫–æ–¥ –æ–¥–∏–Ω –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            hs_code = product.hs_code_le24  # –û–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –ª—é–±–æ–π
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω —Ä–∞–∑–º–µ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            sizes = sorted(product.qty_by_size.keys())
            if sizes:
                min_size = min(sizes)
                max_size = max(sizes)
                insole_text = f"–≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã {min_size}-{max_size}"
            else:
                insole_text = "–≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã"

        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–µ—Å–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
        net_weight = product.net_weight_per_pair * quantity

        # –ë—Ä—É—Ç—Ç–æ: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Ç –±—Ä—É—Ç—Ç–æ –∑–∞ –∫–æ—Ä–æ–±–∫—É
        # (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ boxes —É–∫–∞–∑–∞–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)
        if product.total_pairs > 0:
            gross_weight = (product.gross_weight_per_box * product.boxes * quantity) / product.total_pairs
        else:
            gross_weight = Decimal(0)

        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–æ–±–æ–∫ –±–µ—Ä–µ–º –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ë–ï–ó –ø–µ—Ä–µ—Å—á–µ—Ç–∞
        # –î–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (le24/gt24) boxes –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
        boxes = product.boxes

        # –°—É–º–º–∞
        amount = product.price * quantity

        return OutputLine(
            brand=product.brand,
            hs_code=hs_code,
            article=product.article,
            description=product.name,
            color=product.color,
            material=product.material,
            lining=product.lining,
            sole=product.sole,
            heel_height=product.heel_height,
            insole_category=insole_text,
            quantity=quantity,
            net_weight=round(net_weight, 3),
            gross_weight=round(gross_weight, 3),
            boxes=boxes if category in ["le24", "all"] else 0,  # –ö–æ—Ä–æ–±–∫–∏ —É–∫–∞–∑—ã–≤–∞–µ–º –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π
            original_boxes=product.boxes,  # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û: –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–æ–±–æ–∫
            price=product.price,
            amount=round(amount, 2),
            kiz_codes=[]
        )
```

---

### üìÑ –§–∞–π–ª: `src/generators/__init__.py`

```python
"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø –ë–ï–ó –ì–†–£–ü–ü–ò–†–û–í–ö–ò)
"""
from .invoice import InvoiceGenerator
from .specification import SpecificationGenerator
from .packing_list import PackingListGenerator

__all__ = ['InvoiceGenerator', 'SpecificationGenerator', 'PackingListGenerator']
```

---

### üìÑ –§–∞–π–ª: `src/generators/invoice.py`

```python
"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Invoice –ë–ï–ó –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ output_lines –ø–æ–¥—Ä—è–¥
"""
import pandas as pd
from typing import List
from ..models import OutputLine, DocumentMetadata


class InvoiceGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ò–Ω–≤–æ–π—Å–∞"""

    def __init__(self, config: dict, preset: dict):
        self.config = config
        self.preset = preset

    def generate(
            self,
            lines: List[OutputLine],
            metadata: DocumentMetadata,
            output_path: str
    ) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Invoice –ø–æ —à–∞–±–ª–æ–Ω—É
        
        Returns:
            –ø—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É
        """

        rows = []

        # –®–∞–ø–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        seller_name_full = f"{metadata.seller_name} ({metadata.seller_name_en})" if metadata.seller_name_en else metadata.seller_name
        rows.append([seller_name_full])
        rows.append([metadata.seller_address])
        rows.append([metadata.seller_address_en if metadata.seller_address_en else ''])
        rows.append([f"–¢–ï–õ/TEL:  {self.preset['seller']['phone']}"])
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        rows.append([f"COMMERCIAL INVOICE / –ö–û–ú–ú–ï–†–ß–ï–°–ö–ò–ô –ò–ù–í–û–ô–° ‚Ññ {metadata.invoice_number} from/–æ—Ç {metadata.date}"])
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        rows.append([f"Buyer / –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: {metadata.buyer_name}\n{metadata.buyer_address}"])
        rows.append([f"Contract / –ö–æ–Ω—Ç—Ä–∞–∫—Ç ‚Ññ{metadata.contract_number} from/–æ—Ç {metadata.contract_date}"])
        
        container_text = f"Terms of delivery / –£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏: {metadata.terms_of_delivery}"
        container_row = [container_text, '', '', '', '', '', '', '', '', f"Container No / –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Ññ", metadata.container_number]
        rows.append(container_row)
        
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
        header = [
            "‚Ññ",
            "Brand / –ú–∞—Ä–∫–∞",
            "Code / –ö–æ–¥ –¢–ù–í–≠–î",
            "Factory code / –ê—Ä—Ç–∏–∫—É–ª",
            " Description / –û–ø–∏—Å–∞–Ω–∏–µ",
            "Qty of pairs\n–ö–æ–ª-–≤–æ –ø–∞—Ä",
            "Net weight\n–í–µ—Å –Ω–µ—Ç—Ç–æ, –∫–≥",
            "Gross weight\n–í–µ—Å –±—Ä—É—Ç—Ç–æ, –∫–≥",
            "Qty of places\n–ö–æ–ª-–≤–æ –º–µ—Å—Ç",
            "Price / –¶–µ–Ω–∞, cny",
            "Amount / \n–°—É–º–º–∞, cny"
        ]
        rows.append(header)

        # –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ë–ï–ó –ì–†–£–ü–ü–ò–†–û–í–ö–ò - –ø—Ä–æ—Å—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥—Ä—è–¥!
        total_qty = 0
        total_net = 0
        total_gross = 0
        total_boxes = 0
        total_amount = 0
        
        data_start_row = 13  # –°—Ç—Ä–æ–∫–∞, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ (–ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
        
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–∞—Ä—ã —Å—Ç—Ä–æ–∫ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è boxes
        item_number = 0
        prev_line = None

        for idx, line in enumerate(lines):
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ "–≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å—é" –∞—Ä—Ç–∏–∫—É–ª–∞
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫
            if not is_continuation:
                item_number += 1
            
            rows.append([
                '' if is_continuation else item_number,  # –ù–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏
                '' if is_continuation else line.brand,
                line.hs_code,
                '' if is_continuation else line.article,
                f"{line.description}, –º–∞—Ç–µ—Ä–∏–∞–ª –≤–µ—Ä—Ö–∞: {line.material}, {line.insole_category}",
                line.quantity,
                float(line.net_weight),
                float(line.gross_weight),
                '',  # Boxes - –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —è—á–µ–µ–∫
                float(line.price),
                float(line.amount)
            ])

            total_qty += line.quantity
            total_net += line.net_weight
            total_gross += line.gross_weight
            # –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç boxes
            # –î–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã (is_continuation) –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º boxes,
            # —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —É–∂–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
            if not is_continuation:
                total_boxes += line.boxes
            total_amount += line.amount
            
            prev_line = line

        data_end_row = len(rows)  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

        # –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
        rows.append([
            '',
            '',
            '',
            '',
            'Total / –ò—Ç–æ–≥–æ:',
            total_qty,
            round(float(total_net), 3),
            round(float(total_gross), 3),
            total_boxes,
            '',
            f"¬•{total_amount:,.2f}".replace(',', ' ')
        ])

        # –§—É—Ç–µ—Ä (—Ç–æ–ª—å–∫–æ –¥–ª—è Invoice - –ë–ï–ó Terms of delivery –∏ –ë–ï–ó –ø–æ–¥–ø–∏—Å–µ–π!)
        rows.append([f"-Manufacturer / –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å: {metadata.seller_name}"])
        rows.append([f"-Country of origin / –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è: {self.preset['delivery']['country_of_origin_en']} / {self.preset['delivery']['country_of_origin']}"])
        rows.append(["-Country of destination / –°—Ç—Ä–∞–Ω–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: Russia / –†–æ—Å—Å–∏—è"])
        rows.append(["-Product not for military use / –¢–æ–≤–∞—Ä –Ω–µ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –≤–æ–µ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö"])
        rows.append(["-Terms of payment / –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã:"])
        rows.append([f"Payment of the cost of this transaction for the delivery of the goods specified above in the framework of the execution of Contract No. {metadata.contract_number} dated {metadata.contract_date} in the amount of ¬• {total_amount:,.2f} is payable no later than 120 days from the date of filing the Declaration for the goods in the country of Import./ –û–ø–ª–∞—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω–æ–π —Å–¥–µ–ª–∫–∏ –ø–æ –ø–æ—Å—Ç–∞–≤–∫–µ —Ç–æ–≤–∞—Ä–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ –≤ —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∞ ‚Ññ {metadata.contract_number} –æ—Ç {metadata.contract_date} –≥. –≤ —Ä–∞–∑–º–µ—Ä–µ ¬• {total_amount:,.2f} –ø–æ–¥–ª–µ–∂–∏—Ç –æ–ø–ª–∞—Ç–µ –Ω–µ –ø–æ–∑–¥–Ω–µ–µ 120 –¥–Ω–µ–π —Å –¥–∞—Ç—ã –ø–æ–¥–∞—á–∏ –î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ –Ω–∞ —Ç–æ–≤–∞—Ä –≤ —Å—Ç—Ä–∞–Ω–µ –ò–º–ø–æ—Ä—Ç–∞"])

        # –°–æ–∑–¥–∞–µ–º DataFrame –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        df = pd.DataFrame(rows)
        # –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —á—Ç–æ–±—ã —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–ª—Å—è
        with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
            df.to_excel(writer, index=False, header=False)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes –¥–ª—è –ø–∞—Ä —Å—Ç—Ä–æ–∫
        from openpyxl import load_workbook
        wb = load_workbook(output_path)
        ws = wb.active
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º boxes –¥–ª—è –ø–∞—Ä
        prev_line = None
        current_row = data_start_row
        
        for line in lines:
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            if is_continuation:
                # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes (–∫–æ–ª–æ–Ω–∫–∞ I) –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
                ws.merge_cells(f'I{current_row-1}:I{current_row}')
                # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ò–°–•–û–î–ù–û–ï –∑–Ω–∞—á–µ–Ω–∏–µ boxes (—Å—É–º–º–∞ –æ–±–µ–∏—Ö —Å—Ç—Ä–æ–∫)
                ws[f'I{current_row-1}'] = line.original_boxes  # ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º original_boxes
            elif line.boxes > 0:
                # –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                ws[f'I{current_row}'] = line.boxes
            
            current_row += 1
            prev_line = line
        
        wb.save(output_path)
        wb.close()
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        from ..formatters import InvoiceFormatter
        formatter = InvoiceFormatter(self.config)
        formatter.format(output_path, data_start_row, data_end_row)
        
        return output_path
```

---

### üìÑ –§–∞–π–ª: `src/generators/specification.py`

```python
"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Specification –ë–ï–ó –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ output_lines –ø–æ–¥—Ä—è–¥
"""
import pandas as pd
from typing import List
from ..models import OutputLine, DocumentMetadata


class SpecificationGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏"""

    def __init__(self, config: dict, preset: dict):
        self.config = config
        self.preset = preset

    def generate(
            self,
            lines: List[OutputLine],
            metadata: DocumentMetadata,
            output_path: str
    ) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Specification"""

        rows = []

        # –®–∞–ø–∫–∞
        rows.append(['', '', '', '', '', '', '', '', '', '', '', '', '–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –∫ –ö–æ–Ω—Ç—Ä–∞–∫—Ç—É/', '', '', '', '', ''])
        rows.append(['', '', '', '', '', '', '', '', '', '', '', '', 'Specification to the Contract', '', '', '', '', ''])
        rows.append(['', '', '', '', '', '', '', '', '', '', '', '', f'‚Ññ{metadata.contract_number} from/–æ—Ç {metadata.contract_date}', '', '', '', '', ''])
        rows.append(['', '', '', '', '', '', '', '', '', '', '', '', f'Container / –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Ññ {metadata.container_number}', '', '', '', '', ''])
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ 5
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ 6
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ 7
        rows.append([f'Specification / –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Ññ {metadata.invoice_number} from/–æ—Ç {metadata.date}'])

        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ 9

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
        header = [
            "‚Ññ",
            "Brand / –ú–∞—Ä–∫–∞",
            "Code / –ö–æ–¥ –¢–ù–í–≠–î",
            "Factory code / –ê—Ä—Ç–∏–∫—É–ª",
            " Description / –û–ø–∏—Å–∞–Ω–∏–µ",
            "Color / –¶–≤–µ—Ç",
            "Top material / –ú–∞—Ç–µ—Ä–∏–∞–ª –≤–µ—Ä—Ö–∞",
            "Lining material / –ú–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–¥–∫–ª–∞–¥–∫–∏",
            "Outsole material / –ú–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–¥–æ—à–≤—ã",
            "Heel height / –í—ã—Å–æ—Ç–∞ –∫–∞–±–ª—É–∫–∞",
            "Insole length / –î–ª–∏–Ω–∞ —Å—Ç–µ–ª—å–∫–∏",
            "Quantity of pairs / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä",
            "Net weight (kg) / –í–µ—Å –Ω–µ—Ç—Ç–æ (–∫–≥)",
            "Gross weight (kg) / –í–µ—Å –±—Ä—É—Ç—Ç–æ (–∫–≥)",
            "Quantity of places / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç",
            "Price / –¶–µ–Ω–∞, cny",
            "Amount / –°—É–º–º–∞, cny",
            "–ö–ò–ó"
        ]
        rows.append(header)

        # –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ë–ï–ó –ì–†–£–ü–ü–ò–†–û–í–ö–ò - –ø—Ä–æ—Å—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥—Ä—è–¥!
        total_qty = 0
        total_net = 0
        total_gross = 0
        total_boxes = 0
        total_amount = 0
        
        data_start_row = 11  # –°—Ç—Ä–æ–∫–∞, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
        
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–∞—Ä—ã —Å—Ç—Ä–æ–∫
        item_number = 0
        prev_line = None

        for idx, line in enumerate(lines):
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ "–≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å—é" –∞—Ä—Ç–∏–∫—É–ª–∞
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫
            if not is_continuation:
                item_number += 1

            rows.append([
                '' if is_continuation else item_number,
                '' if is_continuation else line.brand,
                line.hs_code,
                '' if is_continuation else line.article,
                '' if is_continuation else line.description,
                '' if is_continuation else line.color,
                '' if is_continuation else line.material,
                '' if is_continuation else line.lining,
                '' if is_continuation else line.sole,
                '' if is_continuation else line.heel_height,
                line.insole_category,
                line.quantity,
                float(line.net_weight),
                float(line.gross_weight),
                '',  # Boxes - –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
                float(line.price),
                float(line.amount),
                ' '.join(line.kiz_codes) if line.kiz_codes else ''
            ])

            total_qty += line.quantity
            total_net += line.net_weight
            total_gross += line.gross_weight
            # –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç boxes
            # –î–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã (is_continuation) –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º boxes,
            # —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —É–∂–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
            if not is_continuation:
                total_boxes += line.boxes
            total_amount += line.amount
            
            prev_line = line

        data_end_row = len(rows)  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

        # –ò—Ç–æ–≥–∏
        rows.append([
            '',
            '',
            '',
            '',
            'Total / –ò—Ç–æ–≥–æ:',
            '',
            '',
            '',
            '',
            '',
            '',
            total_qty,
            round(float(total_net), 3),
            round(float(total_gross), 3),
            total_boxes,
            '',
            float(total_amount),
            ''
        ])

        # –§—É—Ç–µ—Ä —Å –ø–æ–¥–ø–∏—Å—è–º–∏ (–¥–ª—è Specification - –° Terms of delivery –∏ –° –ø–æ–¥–ø–∏—Å—è–º–∏!)
        rows.append([f"-Manufacturer / –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å: {metadata.seller_name}"])
        rows.append([f"-Country of origin / –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è: {self.preset['delivery']['country_of_origin_en']} / {self.preset['delivery']['country_of_origin']}"])
        rows.append(["-Country of destination / –°—Ç—Ä–∞–Ω–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: Russia / –†–æ—Å—Å–∏—è"])
        rows.append(["-Product not for military use / –¢–æ–≤–∞—Ä –Ω–µ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –≤–æ–µ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö"])
        rows.append([f"-Terms of delivery / –£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏: {metadata.terms_of_delivery}"])
        rows.append(["-Terms of payment / –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã:"])
        rows.append([f"Payment of the cost of this transaction for the delivery of the goods specified above in the framework of the execution of Contract No. {metadata.contract_number} dated {metadata.contract_date} in the amount of ¬• {total_amount:,.2f} is payable no later than 120 days from the date of filing the Declaration for the goods in the country of Import./ –û–ø–ª–∞—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω–æ–π —Å–¥–µ–ª–∫–∏ –ø–æ –ø–æ—Å—Ç–∞–≤–∫–µ —Ç–æ–≤–∞—Ä–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ –≤ —Ä–∞–º–∫–∞—Ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∞ ‚Ññ {metadata.contract_number} –æ—Ç {metadata.contract_date} –≥. –≤ —Ä–∞–∑–º–µ—Ä–µ ¬• {total_amount:,.2f} –ø–æ–¥–ª–µ–∂–∏—Ç –æ–ø–ª–∞—Ç–µ –Ω–µ –ø–æ–∑–¥–Ω–µ–µ 120 –¥–Ω–µ–π —Å –¥–∞—Ç—ã –ø–æ–¥–∞—á–∏ –î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ –Ω–∞ —Ç–æ–≤–∞—Ä –≤ —Å—Ç—Ä–∞–Ω–µ –ò–º–ø–æ—Ä—Ç–∞"])

        # –ü–æ–¥–ø–∏—Å–∏ (—Ç–æ–ª—å–∫–æ –≤ Specification!)
        rows.append(['', 'Buyer / –ü–æ–∫—É–ø–∞—Ç–µ–ª—å:', '', '', '', '', '', '', '', '', 'Seller / –ü—Ä–æ–¥–∞–≤–µ—Ü:', '', '', '', '', '', '', ''])
        rows.append(['', metadata.buyer_name.split('/')[0].strip(), '', '', '', '', '', '', '', '', metadata.seller_name, '', '', '', '', '', '', ''])

        # –°–æ–∑–¥–∞–µ–º DataFrame –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
        df = pd.DataFrame(rows)
        # –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —á—Ç–æ–±—ã —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–ª—Å—è
        with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
            df.to_excel(writer, index=False, header=False)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes –¥–ª—è –ø–∞—Ä —Å—Ç—Ä–æ–∫
        from openpyxl import load_workbook
        wb = load_workbook(output_path)
        ws = wb.active
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º boxes –¥–ª—è –ø–∞—Ä
        prev_line = None
        current_row = data_start_row
        
        for line in lines:
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            if is_continuation:
                # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes (–∫–æ–ª–æ–Ω–∫–∞ O) –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
                ws.merge_cells(f'O{current_row-1}:O{current_row}')
                # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ò–°–•–û–î–ù–û–ï –∑–Ω–∞—á–µ–Ω–∏–µ boxes (—Å—É–º–º–∞ –æ–±–µ–∏—Ö —Å—Ç—Ä–æ–∫)
                ws[f'O{current_row-1}'] = line.original_boxes  # ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º original_boxes
            elif line.boxes > 0:
                # –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                ws[f'O{current_row}'] = line.boxes
            
            current_row += 1
            prev_line = line
        
        wb.save(output_path)
        wb.close()
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        from ..formatters import SpecificationFormatter
        formatter = SpecificationFormatter(self.config)
        formatter.format(output_path, data_start_row, data_end_row)
        
        return output_path
```

---

### üìÑ –§–∞–π–ª: `src/generators/packing_list.py`

```python
"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Packing List –ë–ï–ó –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
–í—ã–≤–æ–¥–∏—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ output_lines –ø–æ–¥—Ä—è–¥
"""
import pandas as pd
from typing import List
from ..models import OutputLine, DocumentMetadata


class PackingListGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –£–ø–∞–∫–æ–≤–æ—á–Ω–æ–≥–æ –ª–∏—Å—Ç–∞"""

    def __init__(self, config: dict, preset: dict):
        self.config = config
        self.preset = preset

    def generate(
            self,
            lines: List[OutputLine],
            metadata: DocumentMetadata,
            output_path: str
    ) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Packing List"""

        rows = []

        # –®–∞–ø–∫–∞
        rows.append([f"{metadata.seller_name} ({self.preset['seller']['name_en']})"])
        rows.append([metadata.seller_address])
        rows.append([metadata.seller_address_en])
        rows.append([f"–¢–ï–õ/TEL:  {self.preset['seller']['phone']}"])
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        rows.append([f"Packing list / –£–ø–∞–∫–æ–≤–æ—á–Ω—ã–π –ª–∏—Å—Ç ‚Ññ {metadata.invoice_number} from/–æ—Ç {metadata.date}"])
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        rows.append([f"Buyer / –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: {metadata.buyer_name}"])
        rows.append([metadata.buyer_address])
        rows.append([f"Contract / –ö–æ–Ω—Ç—Ä–∞–∫—Ç ‚Ññ{metadata.contract_number} from/–æ—Ç {metadata.contract_date}"])
        
        container_text = f"Terms of delivery / –£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏: {metadata.terms_of_delivery}"
        container_row = [container_text, '', '', '', '', '', '', '', '', f"Container No / –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Ññ", metadata.container_number]
        rows.append(container_row)
        
        rows.append([''])  # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        header = [
            "‚Ññ",
            "Brand / –ú–∞—Ä–∫–∞",
            "Code / –ö–æ–¥ –¢–ù–í–≠–î",
            "Factory code / –ê—Ä—Ç–∏–∫—É–ª",
            " Description / –û–ø–∏—Å–∞–Ω–∏–µ",
            "Color / –¶–≤–µ—Ç",
            "Quantity of pairs / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä",
            "Net weight, kg / –í–µ—Å –Ω–µ—Ç—Ç–æ, –∫–≥",
            "Gross weight, kg / –í–µ—Å –±—Ä—É—Ç—Ç–æ, –∫–≥",
            "Quantity of places / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç",
            "Type of packaging / –í–∏–¥ —É–ø–∞–∫–æ–≤–∫–∏"
        ]
        rows.append(header)

        # –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ë–ï–ó –ì–†–£–ü–ü–ò–†–û–í–ö–ò - –ø—Ä–æ—Å—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥—Ä—è–¥!
        total_qty = 0
        total_net = 0
        total_gross = 0
        total_boxes = 0
        
        data_start_row = 14  # –°—Ç—Ä–æ–∫–∞, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
        
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–∞—Ä—ã —Å—Ç—Ä–æ–∫
        item_number = 0
        prev_line = None

        for idx, line in enumerate(lines):
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ "–≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å—é" –∞—Ä—Ç–∏–∫—É–ª–∞
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫
            if not is_continuation:
                item_number += 1

            rows.append([
                '' if is_continuation else item_number,
                '' if is_continuation else line.brand,
                line.hs_code,
                '' if is_continuation else line.article,
                '' if is_continuation else line.description,
                '' if is_continuation else line.color,
                line.quantity,
                float(line.net_weight),
                float(line.gross_weight),
                '',  # Boxes - –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
                "cardboard box / \n–∫–∞—Ä—Ç–æ–Ω–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞" if line.boxes > 0 or is_continuation else ''
            ])

            total_qty += line.quantity
            total_net += line.net_weight
            total_gross += line.gross_weight
            # –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç boxes
            # –î–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—ã (is_continuation) –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º boxes,
            # —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —É–∂–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
            if not is_continuation:
                total_boxes += line.boxes
            
            prev_line = line

        data_end_row = len(rows)  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

        # –ò—Ç–æ–≥–∏
        rows.append(['', '', '', '', '', '–ò—Ç–æ–≥–æ:', total_qty, round(float(total_net), 3), round(float(total_gross), 3), total_boxes, ''])
        rows.append([f"Total net weight, kgs / –û–±—â–∏–π –≤–µ—Å –Ω–µ—Ç—Ç–æ: {total_net:,.2f} –∫–≥"])
        rows.append([f"Total gross weight, kg / –û–±—â–∏–π –≤–µ—Å –±—Ä—É—Ç—Ç–æ: {total_gross:,.2f} –∫–≥"])
        rows.append([f"Total quantity of pairs / –û–±—â–µ–µ –∫–æ–ª-–≤–æ –ø–∞—Ä: {total_qty}"])
        rows.append([f"Total quantity of places / –û–±—â–µ–µ –∫–æ–ª-–≤–æ –º–µ—Å—Ç: {total_boxes}"])

        # –°–æ–∑–¥–∞–µ–º DataFrame –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
        df = pd.DataFrame(rows)
        # –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —á—Ç–æ–±—ã —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–ª—Å—è
        with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
            df.to_excel(writer, index=False, header=False)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes –¥–ª—è –ø–∞—Ä —Å—Ç—Ä–æ–∫
        from openpyxl import load_workbook
        wb = load_workbook(output_path)
        ws = wb.active
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º boxes –¥–ª—è –ø–∞—Ä
        prev_line = None
        current_row = data_start_row
        
        for line in lines:
            is_continuation = (
                prev_line is not None and
                line.article == prev_line.article and
                "–±–æ–ª–µ–µ 24—Å–º" in line.insole_category and
                line.boxes == 0 and
                "–¥–æ 24—Å–º" in prev_line.insole_category
            )
            
            if is_continuation:
                # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ boxes (–∫–æ–ª–æ–Ω–∫–∞ J) –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
                ws.merge_cells(f'J{current_row-1}:J{current_row}')
                # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ò–°–•–û–î–ù–û–ï –∑–Ω–∞—á–µ–Ω–∏–µ boxes (—Å—É–º–º–∞ –æ–±–µ–∏—Ö —Å—Ç—Ä–æ–∫)
                ws[f'J{current_row-1}'] = line.original_boxes  # ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º original_boxes
            elif line.boxes > 0:
                # –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                ws[f'J{current_row}'] = line.boxes
            
            current_row += 1
            prev_line = line
        
        wb.save(output_path)
        wb.close()
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        from ..formatters import PackingListFormatter
        formatter = PackingListFormatter(self.config)
        formatter.format(output_path, data_start_row, data_end_row)
        
        return output_path
```

---

### üìÑ –§–∞–π–ª: `src/formatters/__init__.py`

```python
"""
–ú–æ–¥—É–ª—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
"""
from .invoice_formatter import InvoiceFormatter
from .specification_formatter import SpecificationFormatter
from .packing_list_formatter import PackingListFormatter

__all__ = ['InvoiceFormatter', 'SpecificationFormatter', 'PackingListFormatter']
```

---

### üìÑ –§–∞–π–ª: `src/formatters/invoice_formatter.py`

```python
"""
–§–æ—Ä–º–∞—Ç—Ç–µ—Ä –¥–ª—è Invoice –¥–æ–∫—É–º–µ–Ω—Ç–∞
"""
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, Border, Side, PatternFill
from openpyxl.utils import get_column_letter


class InvoiceFormatter:
    """–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ Invoice"""
    
    def __init__(self, config: dict):
        self.config = config
    
    def format(self, file_path: str, data_start_row: int, data_end_row: int):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Ñ–∞–π–ª—É
        
        Args:
            file_path: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel
            data_start_row: –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
            data_end_row: –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ (–ø–µ—Ä–µ–¥ Total)
        """
        wb = load_workbook(file_path)
        ws = wb.active
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        self._set_column_widths(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        self._format_header(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        self._format_table(ws, data_start_row, data_end_row)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É—Ç–µ—Ä–∞
        self._format_footer(ws, data_end_row)
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        wb.save(file_path)
        wb.close()  # –í–ê–ñ–ù–û: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —á—Ç–æ–±—ã Windows –º–æ–≥ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å
    
    def _set_column_widths(self, ws):
        """–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫"""
        widths = {
            'A': 4.66,
            'B': 11.0,
            'C': 11.83,
            'D': 14.66,
            'E': 91.66,
            'F': 11.66,
            'G': 12.33,
            'H': 13.66,
            'I': 13.33,
            'J': 9.66,
            'K': 14.83
        }
        
        for col, width in widths.items():
            ws.column_dimensions[col].width = width
    
    def _format_header(self, ws):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —à–∞–ø–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        # –°—Ç—Ä–æ–∫–∞ 1: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
        ws.merge_cells('A1:K1')
        cell = ws['A1']
        cell.font = Font(name='Arial', size=16, bold=True)
        cell.alignment = Alignment(horizontal='center', vertical='top', wrap_text=True)
        ws.row_dimensions[1].height = 22.5
        
        # –°—Ç—Ä–æ–∫–∞ 2: –ê–¥—Ä–µ—Å (—Å—Ç—Ä–æ–∫–∞ 1)
        ws.merge_cells('A2:K2')
        cell = ws['A2']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        ws.row_dimensions[2].height = 15.6
        
        # –°—Ç—Ä–æ–∫–∞ 3: –ê–¥—Ä–µ—Å (—Å—Ç—Ä–æ–∫–∞ 2)
        ws.merge_cells('A3:K3')
        cell = ws['A3']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        ws.row_dimensions[3].height = 15.6
        
        # –°—Ç—Ä–æ–∫–∞ 4: –¢–µ–ª–µ—Ñ–æ–Ω
        ws.merge_cells('A4:K4')
        cell = ws['A4']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center')
        ws.row_dimensions[4].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 5: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[5].height = 6.0
        
        # –°—Ç—Ä–æ–∫–∞ 6: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ COMMERCIAL INVOICE
        ws.merge_cells('A6:K6')
        cell = ws['A6']
        cell.font = Font(name='Arial', size=16, bold=True)
        cell.alignment = Alignment(horizontal='center', vertical='top', wrap_text=True)
        ws.row_dimensions[6].height = 21.0
        
        # –°—Ç—Ä–æ–∫–∞ 7: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[7].height = 12.75
        
        # –°—Ç—Ä–æ–∫–∞ 8: Buyer
        ws.merge_cells('A8:K8')
        cell = ws['A8']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
        ws.row_dimensions[8].height = 49.5
        
        # –°—Ç—Ä–æ–∫–∞ 9: Contract
        ws.merge_cells('A9:K9')
        cell = ws['A9']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        ws.row_dimensions[9].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 10: Terms of delivery + Container
        ws.merge_cells('A10:I10')
        cell = ws['A10']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        ws.row_dimensions[10].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 11: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[11].height = 6.0
    
    def _format_table(self, ws, data_start_row, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏"""
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä–æ–∫–∞ 12)
        header_row = 12
        ws.row_dimensions[header_row].height = 33.75
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        for col in range(1, 12):  # A-K
            cell = ws.cell(row=header_row, column=col)
            cell.font = Font(name='Arial', size=10, bold=True)
            cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
            cell.border = thin_border
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
        for row in range(data_start_row, data_end_row + 1):
            for col in range(1, 12):
                cell = ws.cell(row=row, column=col)
                cell.border = thin_border
                
                # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
                if col == 1:  # ‚Ññ
                    cell.alignment = Alignment(horizontal='center', vertical='center')
                    cell.font = Font(name='Arial', size=10)
                elif col in [2, 3, 4]:  # Brand, Code, Article
                    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
                    cell.font = Font(name='Arial', size=10)
                elif col == 5:  # Description
                    cell.alignment = Alignment(horizontal='left', vertical='center', wrap_text=True)
                    cell.font = Font(name='Arial', size=10)
                else:  # –ß–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
                    cell.alignment = Alignment(horizontal='right', vertical='center')
                    cell.font = Font(name='Arial', size=10)
    
    def _format_footer(self, ws, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ñ—É—Ç–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        total_row = data_end_row + 1
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –°—Ç—Ä–æ–∫–∞ Total
        for col in range(1, 12):
            cell = ws.cell(row=total_row, column=col)
            cell.border = thin_border
            cell.font = Font(name='Arial', size=10, bold=True)
            
            if col == 5:  # "Total / –ò—Ç–æ–≥–æ:"
                cell.alignment = Alignment(horizontal='right', vertical='center')
            elif col in [6, 7, 8, 9]:  # –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
                cell.alignment = Alignment(horizontal='right', vertical='center')
            elif col == 11:  # Amount
                cell.alignment = Alignment(horizontal='right', vertical='center')
            else:
                cell.alignment = Alignment(horizontal='center', vertical='center')
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã
        info_start = total_row + 1
        
        for row_offset in range(0, 7):  # 7 —Å—Ç—Ä–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            row = info_start + row_offset
            ws.merge_cells(f'A{row}:K{row}')
            cell = ws[f'A{row}']
            cell.font = Font(name='Arial', size=10)
            cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
```

---

### üìÑ –§–∞–π–ª: `src/formatters/specification_formatter.py`

```python
"""
–§–æ—Ä–º–∞—Ç—Ç–µ—Ä –¥–ª—è Specification –¥–æ–∫—É–º–µ–Ω—Ç–∞
"""
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, Border, Side
from openpyxl.utils import get_column_letter


class SpecificationFormatter:
    """–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ Specification"""
    
    def __init__(self, config: dict):
        self.config = config
    
    def format(self, file_path: str, data_start_row: int, data_end_row: int):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Ñ–∞–π–ª—É
        
        Args:
            file_path: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel
            data_start_row: –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
            data_end_row: –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
        """
        wb = load_workbook(file_path)
        ws = wb.active
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        self._set_column_widths(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        self._format_header(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        self._format_table(ws, data_start_row, data_end_row)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É—Ç–µ—Ä–∞
        self._format_footer(ws, data_end_row)
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        wb.save(file_path)
        wb.close()  # –í–ê–ñ–ù–û: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —á—Ç–æ–±—ã Windows –º–æ–≥ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å
    
    def _set_column_widths(self, ws):
        """–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫"""
        widths = {
            'A': 3.33,   # ‚Ññ
            'B': 13.33,  # Brand
            'C': 12.0,   # Code
            'D': 18.5,   # Factory code
            'E': 21.0,   # Description
            'F': 14.0,   # Color
            'G': 22.0,   # Top material
            'H': 14.33,  # Lining material
            'I': 15.5,   # Outsole material
            'J': 12.16,  # Heel height
            'K': 15.33,  # Insole length
            'L': 12.16,  # Quantity
            'M': 15.0,   # Net weight
            'N': 18.83,  # Gross weight
            'O': 13.16,  # Quantity of places
            'P': 11.0,   # Price
            'Q': 15.0,   # Amount
            'R': 25.0    # KIZ codes
        }
        
        for col, width in widths.items():
            ws.column_dimensions[col].width = width
    
    def _format_header(self, ws):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —à–∞–ø–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        # –°—Ç—Ä–æ–∫–∏ 1-3: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –∫ –ö–æ–Ω—Ç—Ä–∞–∫—Ç—É (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ)
        for row in [1, 2, 3]:
            ws.merge_cells(f'A{row}:R{row}')
            cell = ws[f'A{row}']
            cell.font = Font(name='Arial', size=14, bold=True)
            cell.alignment = Alignment(horizontal='right', vertical='center')
        
        # –°—Ç—Ä–æ–∫–∞ 4: Container
        ws.merge_cells('A4:R4')
        cell = ws['A4']
        cell.font = Font(name='Arial', size=12)
        cell.alignment = Alignment(horizontal='right', vertical='center')
        
        # –°—Ç—Ä–æ–∫–∞ 5: –ø—É—Å—Ç–∞—è
        
        # –°—Ç—Ä–æ–∫–∞ 6: –ø—É—Å—Ç–∞—è
        
        # –°—Ç—Ä–æ–∫–∞ 7: –ø—É—Å—Ç–∞—è
        
        # –°—Ç—Ä–æ–∫–∞ 8: Specification ‚Ññ ... from ...
        ws.merge_cells('A8:R8')
        cell = ws['A8']
        cell.font = Font(name='Arial', size=14, bold=True)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        
        # –°—Ç—Ä–æ–∫–∞ 9: –ø—É—Å—Ç–∞—è
    
    def _format_table(self, ws, data_start_row, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏"""
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä–æ–∫–∞ 10)
        header_row = 10
        ws.row_dimensions[header_row].height = 60
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (18 –∫–æ–ª–æ–Ω–æ–∫ A-R)
        for col in range(1, 19):
            cell = ws.cell(row=header_row, column=col)
            cell.font = Font(name='Arial', size=9, bold=True)
            cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
            cell.border = thin_border
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
        for row in range(data_start_row, data_end_row + 1):
            for col in range(1, 19):
                cell = ws.cell(row=row, column=col)
                cell.border = thin_border
                cell.font = Font(name='Arial', size=9)
                
                # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
                if col == 1:  # ‚Ññ
                    cell.alignment = Alignment(horizontal='center', vertical='center')
                elif col in [2, 3, 4]:  # Brand, Code, Article
                    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
                elif col in [5, 6, 7, 8, 9, 10, 11]:  # –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è
                    cell.alignment = Alignment(horizontal='left', vertical='center', wrap_text=True)
                elif col == 18:  # KIZ codes
                    cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
                else:  # –ß–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
                    cell.alignment = Alignment(horizontal='right', vertical='center')
    
    def _format_footer(self, ws, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ñ—É—Ç–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        total_row = data_end_row + 1
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –°—Ç—Ä–æ–∫–∞ Total
        for col in range(1, 19):
            cell = ws.cell(row=total_row, column=col)
            cell.border = thin_border
            cell.font = Font(name='Arial', size=10, bold=True)
            cell.alignment = Alignment(horizontal='right', vertical='center')
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã
        info_start = total_row + 1
        
        for row_offset in range(0, 9):  # 9 —Å—Ç—Ä–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è –ø–æ–¥–ø–∏—Å–∏)
            row = info_start + row_offset
            ws.merge_cells(f'A{row}:R{row}')
            cell = ws[f'A{row}']
            cell.font = Font(name='Arial', size=10)
            cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
        
        # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π (Buyer/Seller)
        signature_row = info_start + 9
        ws.merge_cells(f'A{signature_row}:I{signature_row}')
        ws.merge_cells(f'J{signature_row}:R{signature_row}')
        
        cell = ws[f'A{signature_row}']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        
        cell = ws[f'J{signature_row}']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        
        # –°—Ç—Ä–æ–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–æ–º–ø–∞–Ω–∏–π
        company_row = signature_row + 1
        ws.merge_cells(f'A{company_row}:I{company_row}')
        ws.merge_cells(f'J{company_row}:R{company_row}')
        
        cell = ws[f'A{company_row}']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        
        cell = ws[f'J{company_row}']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
```

---

### üìÑ –§–∞–π–ª: `src/formatters/packing_list_formatter.py`

```python
"""
–§–æ—Ä–º–∞—Ç—Ç–µ—Ä –¥–ª—è Packing List –¥–æ–∫—É–º–µ–Ω—Ç–∞
"""
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, Border, Side


class PackingListFormatter:
    """–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ Packing List"""
    
    def __init__(self, config: dict):
        self.config = config
    
    def format(self, file_path: str, data_start_row: int, data_end_row: int):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Ñ–∞–π–ª—É
        
        Args:
            file_path: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel
            data_start_row: –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
            data_end_row: –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
        """
        wb = load_workbook(file_path)
        ws = wb.active
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        self._set_column_widths(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        self._format_header(ws)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        self._format_table(ws, data_start_row, data_end_row)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É—Ç–µ—Ä–∞
        self._format_footer(ws, data_end_row)
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        wb.save(file_path)
        wb.close()  # –í–ê–ñ–ù–û: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —á—Ç–æ–±—ã Windows –º–æ–≥ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å
    
    def _set_column_widths(self, ws):
        """–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫"""
        widths = {
            'A': 3.33,   # ‚Ññ
            'B': 13.5,   # Brand
            'C': 13.33,  # Code
            'D': 16.0,   # Factory code
            'E': 27.0,   # Description
            'F': 21.0,   # Color
            'G': 17.16,  # Quantity
            'H': 17.5,   # Net weight
            'I': 19.66,  # Gross weight
            'J': 18.66,  # Quantity of places
            'K': 21.16   # Type of packaging
        }
        
        for col, width in widths.items():
            ws.column_dimensions[col].width = width
    
    def _format_header(self, ws):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —à–∞–ø–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        # –°—Ç—Ä–æ–∫–∞ 1: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
        ws.merge_cells('A1:K1')
        cell = ws['A1']
        cell.font = Font(name='Arial', size=16, bold=True)
        cell.alignment = Alignment(horizontal='center', vertical='top', wrap_text=True)
        ws.row_dimensions[1].height = 22.5
        
        # –°—Ç—Ä–æ–∫–∞ 2: –ê–¥—Ä–µ—Å (—Å—Ç—Ä–æ–∫–∞ 1)
        ws.merge_cells('A2:K2')
        cell = ws['A2']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        ws.row_dimensions[2].height = 15.6
        
        # –°—Ç—Ä–æ–∫–∞ 3: –ê–¥—Ä–µ—Å (—Å—Ç—Ä–æ–∫–∞ 2)
        ws.merge_cells('A3:K3')
        cell = ws['A3']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        ws.row_dimensions[3].height = 15.6
        
        # –°—Ç—Ä–æ–∫–∞ 4: –¢–µ–ª–µ—Ñ–æ–Ω
        ws.merge_cells('A4:K4')
        cell = ws['A4']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='center', vertical='center')
        ws.row_dimensions[4].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 5: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[5].height = 6.0
        
        # –°—Ç—Ä–æ–∫–∞ 6: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ Packing list
        ws.merge_cells('A6:K6')
        cell = ws['A6']
        cell.font = Font(name='Arial', size=16, bold=True)
        cell.alignment = Alignment(horizontal='center', vertical='top', wrap_text=True)
        ws.row_dimensions[6].height = 21.0
        
        # –°—Ç—Ä–æ–∫–∞ 7: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[7].height = 12.75
        
        # –°—Ç—Ä–æ–∫–∞ 8: Buyer
        ws.merge_cells('A8:K8')
        cell = ws['A8']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
        ws.row_dimensions[8].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 9: –ê–¥—Ä–µ—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
        ws.merge_cells('A9:K9')
        cell = ws['A9']
        cell.font = Font(name='Arial', size=11)
        cell.alignment = Alignment(horizontal='left', vertical='top', wrap_text=True)
        ws.row_dimensions[9].height = 49.5
        
        # –°—Ç—Ä–æ–∫–∞ 10: Contract
        ws.merge_cells('A10:K10')
        cell = ws['A10']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        ws.row_dimensions[10].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 11: Terms of delivery + Container
        ws.merge_cells('A11:I11')
        cell = ws['A11']
        cell.font = Font(name='Arial', size=10)
        cell.alignment = Alignment(horizontal='left', vertical='center')
        ws.row_dimensions[11].height = 14.25
        
        # –°—Ç—Ä–æ–∫–∞ 12: –ø—É—Å—Ç–∞—è
        ws.row_dimensions[12].height = 6.0
    
    def _format_table(self, ws, data_start_row, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏"""
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä–æ–∫–∞ 13)
        header_row = 13
        ws.row_dimensions[header_row].height = 50
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        for col in range(1, 12):  # A-K
            cell = ws.cell(row=header_row, column=col)
            cell.font = Font(name='Arial', size=10, bold=True)
            cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
            cell.border = thin_border
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
        for row in range(data_start_row, data_end_row + 1):
            for col in range(1, 12):
                cell = ws.cell(row=row, column=col)
                cell.border = thin_border
                cell.font = Font(name='Arial', size=10)
                
                # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
                if col == 1:  # ‚Ññ
                    cell.alignment = Alignment(horizontal='center', vertical='center')
                elif col in [2, 3, 4]:  # Brand, Code, Article
                    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
                elif col in [5, 6]:  # Description, Color
                    cell.alignment = Alignment(horizontal='left', vertical='center', wrap_text=True)
                elif col == 11:  # Type of packaging
                    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
                else:  # –ß–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
                    cell.alignment = Alignment(horizontal='right', vertical='center')
    
    def _format_footer(self, ws, data_end_row):
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ñ—É—Ç–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        total_row = data_end_row + 1
        
        thin_border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
        
        # –°—Ç—Ä–æ–∫–∞ Total (–ò—Ç–æ–≥–æ:)
        for col in range(1, 12):
            cell = ws.cell(row=total_row, column=col)
            cell.border = thin_border
            cell.font = Font(name='Arial', size=10, bold=True)
            
            if col == 6:  # "–ò—Ç–æ–≥–æ:"
                cell.alignment = Alignment(horizontal='right', vertical='center')
            elif col in [7, 8, 9, 10]:  # –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
                cell.alignment = Alignment(horizontal='right', vertical='center')
            else:
                cell.alignment = Alignment(horizontal='center', vertical='center')
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã (4 —Å—Ç—Ä–æ–∫–∏)
        info_start = total_row + 1
        
        for row_offset in range(0, 4):
            row = info_start + row_offset
            ws.merge_cells(f'A{row}:K{row}')
            cell = ws[f'A{row}']
            cell.font = Font(name='Arial', size=11, bold=True)
            cell.alignment = Alignment(horizontal='left', vertical='center')
```

---

## üìå –ö–û–ù–ï–¶ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

_–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Shusteri Automation_  
_–í–µ—Ä—Å–∏—è: 1.0 Complete_  
_–î–∞—Ç–∞: 2025-01-16_  
_–ê–≤—Ç–æ—Ä: Rostislav_
